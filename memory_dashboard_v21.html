<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyperscaler Memory & Infrastructure Insights Dashboard - Hyperscaler Insights Deepdive</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e2e8f0;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: #2d3748;
            border-radius: 15px;
            padding: 40px 40px 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #4a5568;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            color: #a0aec0;
        }

        /* Module Navigation */
        .module-nav {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .module-btn {
            padding: 12px 24px;
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 8px;
            color: #a0aec0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .module-btn:hover, .module-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        /* Dashboard Sections */
        .dashboard-section {
            margin-bottom: 35px;
            display: none;
        }

        .dashboard-section.active {
            display: block;
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4a5568;
        }

        /* Stats Grid */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #a0aec0;
        }

        /* Alerts Panel */
        .alerts-panel {
            background: rgba(229, 62, 62, 0.1);
            border: 2px solid #e53e3e;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .alert-item {
            padding: 12px;
            margin-bottom: 10px;
            background: #1a202c;
            border-radius: 8px;
            border-left: 4px solid #e53e3e;
        }

        .alert-item.warning {
            border-left-color: #ed8936;
        }

        .alert-item.info {
            border-left-color: #667eea;
        }

        .alert-title {
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 5px;
        }

        .alert-message {
            color: #a0aec0;
            font-size: 0.9rem;
        }

        /* Card Grids */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .metric-card {
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .metric-name {
            font-size: 1.1rem;
            font-weight: 700;
            color: #e2e8f0;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
        }

        .metric-description {
            color: #a0aec0;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        /* Chart Containers */
        .chart-container {
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            min-height: 400px;
            position: relative;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            flex-wrap: wrap;
        }

        .chart-title-secondary {
            font-size: 0.8rem;
            font-weight: 500;
            color: #a0aec0;
        }

        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #4a5568;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .legend-text {
            font-size: 0.85rem;
            color: #a0aec0;
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(26, 32, 44, 0.98);
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 12px;
            pointer-events: none;
            z-index: 1000;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        .tooltip-title {
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .tooltip-item {
            color: #a0aec0;
            font-size: 0.85rem;
            margin: 4px 0;
            line-height: 1.5;
        }

        .tooltip-item strong {
            color: #e2e8f0;
        }

        /* Annotations */
        .annotation {
            position: absolute;
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 0.75rem;
            color: #e2e8f0;
            pointer-events: none;
            z-index: 100;
        }

        /* Chart Info Panel */
        .chart-info {
            background: rgba(102, 126, 234, 0.05);
            border: 1px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #a0aec0;
            line-height: 1.6;
        }

        /* Chart Rationale */
        .chart-rationale {
            background: rgba(102, 126, 234, 0.08);
            border-left: 4px solid #667eea;
            border-radius: 8px;
            padding: 0;
            margin-top: 25px;
            font-size: 0.95rem;
            color: #e2e8f0;
            line-height: 1.8;
        }

        .chart-rationale-header {
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(102, 126, 234, 0.15);
            border-radius: 8px 8px 0 0;
            margin-bottom: 0;
            transition: all 0.3s ease;
            border-bottom: 1px solid rgba(102, 126, 234, 0.3);
        }

        .chart-rationale-header:hover {
            background: rgba(102, 126, 234, 0.25);
        }

        .chart-rationale-header-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-rationale-header-title::before {
            content: "ℹ";
            font-size: 1.2rem;
            color: #667eea;
        }

        .chart-rationale-header-control {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            color: #a0aec0;
        }

        .chart-rationale-header-icon {
            font-size: 0.9rem;
            color: #667eea;
            font-weight: 700;
            transition: transform 0.3s ease;
        }

        .chart-rationale-content-wrapper {
            padding: 20px;
            display: none;
        }

        .chart-rationale-content-wrapper.expanded {
            display: block;
        }

        .chart-rationale-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-rationale-title::before {
            content: "ℹ";
            font-size: 1.2rem;
            color: #667eea;
        }

        .chart-rationale-content {
            margin-bottom: 15px;
        }

        .chart-rationale-content p {
            margin-bottom: 10px;
        }

        .chart-rationale-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(102, 126, 234, 0.3);
        }

        .chart-rationale-section strong {
            color: #667eea;
            display: block;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .chart-rationale-list {
            list-style: none;
            padding-left: 0;
            margin-top: 8px;
        }

        .chart-rationale-list li {
            margin: 6px 0;
            padding-left: 20px;
            position: relative;
        }

        .chart-rationale-list li::before {
            content: "→";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: 700;
        }

        /* Footer */
        .footer {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #4a5568;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 10px;
            font-size: 0.8rem;
            color: #a0aec0;
        }

        .footer-left,
        .footer-right {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }

        .footer-separator {
            opacity: 0.7;
        }

        @media (max-width: 768px) {
            .footer {
                flex-direction: column;
                align-items: flex-start;
            }

            .footer-right {
                margin-top: 4px;
            }
        }

        /* Heatmap */
        .heatmap-container {
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            overflow: visible;
        }

        /* 2x2 Matrix */
        .matrix-container {
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            min-height: 500px;
        }

        /* Node-link Graph */
        .graph-container {
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            min-height: 500px;
        }

        /* Provider Badges */
        .provider-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            margin-right: 8px;
        }

        .provider-google {
            background: #4285f4;
            color: white;
        }

        .provider-microsoft {
            background: #00a4ef;
            color: white;
        }

        .provider-apple {
            background: #000000;
            color: white;
        }

        .provider-openai {
            background: #ff6b35;
            color: white;
        }

        .provider-anthropic {
            background: #d4a574;
            color: white;
        }

        /* Risk Indicators */
        .risk-low { color: #48bb78; }
        .risk-medium { color: #ed8936; }
        .risk-high { color: #e53e3e; }

        /* Opportunity Quadrant */
        .quadrant {
            position: relative;
            width: 100%;
            height: 500px;
            border: 2px solid #4a5568;
            border-radius: 12px;
            background: #1a202c;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #1a202c;
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-group label {
            color: #a0aec0;
            font-weight: 600;
        }

        .control-group select, .control-group input {
            padding: 8px 12px;
            border: 2px solid #4a5568;
            border-radius: 6px;
            background: #2d3748;
            color: #e2e8f0;
            font-size: 0.9rem;
        }

        .control-group button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .control-group button:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Hyperscaler Memory & Infrastructure Insights Dashboard</h1>
            <p>Hyperscaler Insights Deepdive</p>
        </div>

        <!-- Module Navigation -->
        <div class="module-nav">
            <button class="module-btn active" onclick="showModule('ecosystem')">Ecosystem Moves</button>
            <button class="module-btn" onclick="showModule('memory')">Memory Architecture</button>
        </div>

        <!-- Module 1: Ecosystem Moves -->
        <div id="module-ecosystem" class="dashboard-section active">
            <h2 class="section-title">Module 1: Ecosystem Moves</h2>
            <p style="color: #a0aec0; margin-bottom: 20px;">
                Tracking hyperscaler releases, capabilities, and strategic patterns
            </p>

            <!-- Controls -->
            <div class="controls">
                <div class="control-group">
                    <label>Provider:</label>
                    <select id="ecosystemProviderFilter">
                        <option value="all">All Providers</option>
                        <option value="Google">Google</option>
                        <option value="Microsoft">Microsoft</option>
                        <option value="OpenAI">OpenAI</option>
                        <option value="Anthropic">Anthropic</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>Timeframe:</label>
                    <select id="ecosystemTimeframeFilter">
                        <option value="quarter">Last Quarter</option>
                        <option value="month">Last Month</option>
                        <option value="year">Last Year</option>
                        <option value="all">All Time</option>
                    </select>
                </div>
            </div>

            <!-- Alerts -->
            <div class="alerts-panel" id="ecosystemAlerts">
                <!-- Alerts will be dynamically inserted -->
            </div>

            <!-- Growth of Memory-Related Product Releases -->
            <div class="chart-container">
                <div class="chart-title">Growth of Memory-Related Product Releases (2023–2025)</div>
                <div id="ecosystemMemoryGrowthChart"></div>
            </div>

            <!-- Chart B: Agent Feature Velocity -->
            <div class="chart-container">
                <div class="chart-title">Agent Feature Velocity (Features per Provider per Quarter)</div>
                <div id="ecosystemAgentVelocityChart"></div>
            </div>
        </div>

        <!-- Module 2: Memory Architecture -->
        <div id="module-memory" class="dashboard-section">
            <h2 class="section-title">Module 2: Memory Architecture</h2>

            <!-- Chart A: Memory Openness vs Lock-In (2x2 Matrix) -->
            <div class="matrix-container">
                <div class="chart-title">Memory Openness vs Lock-In Matrix</div>
                <div id="memoryOpennessMatrix"></div>
            </div>

            <!-- Chart C: Effective Recall Depth Trendline -->
            <div class="chart-container">
                <div class="chart-title">Effective Recall Depth Trendline (Tied to Model Versions)</div>
                <div id="memoryRecallDepthChart"></div>
            </div>
        </div>



        <div class="footer">
            <div class="footer-left">
                <span>Hyperscaler Memory & Infrastructure Insights Dashboard</span>
                <span class="footer-separator">•</span>
                <span>Hyperscaler insights deepdive monitoring</span>
            </div>
            <div class="footer-right">
                <span>Responsive view:</span>
                <span>Use module toggles above to focus on Ecosystem, Memory, or Education.</span>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive data structure for all modules
        const dashboardData = {
            ecosystem: {
                releases: [
                    { 
                        id: 'r1', provider: 'Google', featureType: 'memory', date: '2024-01-15', 
                        feature: 'Gemini Memory API', description: 'Persistent memory for agents',
                        details: 'Enables agents to maintain context across conversations. Supports up to 128K tokens. Includes automatic summarization and retrieval.',
                        impact: 'high', tokens: 128000, adoptionRate: 45, apiEndpoints: 12,
                        linkedFeatures: ['Workspace Graph', 'AI Studio'], regions: ['US', 'EU', 'APAC']
                    },
                    { 
                        id: 'r2', provider: 'Microsoft', featureType: 'memory', date: '2024-02-10', 
                        feature: 'Copilot Memory Layer', description: 'Cross-app memory storage',
                        details: 'Unified memory system across M365 apps. Enables context sharing between Word, Excel, PowerPoint, Teams. 200K token capacity.',
                        impact: 'high', tokens: 200000, adoptionRate: 52, apiEndpoints: 18,
                        linkedFeatures: ['M365 Graph', 'Copilot Studio'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r3', provider: 'Google', featureType: 'agent', date: '2024-01-20', 
                        feature: 'AI Studio', description: 'Agent builder platform',
                        details: 'Visual agent builder with memory integration. Supports multi-turn conversations. Includes testing and deployment tools.',
                        impact: 'high', tokens: 0, adoptionRate: 38, apiEndpoints: 25,
                        linkedFeatures: ['Gemini Memory API', 'Workspace'], regions: ['US', 'EU', 'APAC']
                    },
                    { 
                        id: 'r4', provider: 'Microsoft', featureType: 'agent', date: '2024-02-15', 
                        feature: 'Copilot Studio', description: 'Custom agent creation',
                        details: 'Low-code agent builder for enterprise. Integrates with M365 memory layer. Supports custom prompts and workflows.',
                        impact: 'high', tokens: 0, adoptionRate: 42, apiEndpoints: 22,
                        linkedFeatures: ['Copilot Memory', 'Power Platform'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r5', provider: 'Google', featureType: 'identity', date: '2024-03-05', 
                        feature: 'Workspace Graph Expansion', description: 'Enhanced identity linking',
                        details: 'Expanded identity graph connects more Google services. New permission scopes for cross-app access. Enhanced privacy controls.',
                        impact: 'medium', tokens: 0, adoptionRate: 65, apiEndpoints: 15,
                        linkedFeatures: ['Workspace', 'Identity Platform'], regions: ['Global']
                    },
                    { 
                        id: 'r7', provider: 'Google', featureType: 'api', date: '2024-04-10', 
                        feature: 'Graph API Expansion', description: 'New permission scopes',
                        details: 'Added 12 new API endpoints for memory access. Enhanced OAuth scopes. Improved rate limits for enterprise customers.',
                        impact: 'medium', tokens: 0, adoptionRate: 55, apiEndpoints: 12,
                        linkedFeatures: ['Workspace Graph', 'API Platform'], regions: ['Global']
                    },
                    { 
                        id: 'r8', provider: 'Microsoft', featureType: 'identity', date: '2024-04-15', 
                        feature: 'M365 Graph Integration', description: 'Account context binding',
                        details: 'Deep integration with Azure AD and M365 Graph. Enhanced account context for memory storage. New identity federation options.',
                        impact: 'medium', tokens: 0, adoptionRate: 58, apiEndpoints: 14,
                        linkedFeatures: ['Azure AD', 'M365 Graph'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r9', provider: 'Google', featureType: 'memory', date: '2024-05-01', 
                        feature: 'Memory TTL Controls', description: 'Time-to-live settings',
                        details: 'Granular TTL controls for memory retention. Automatic expiration policies. Enhanced deletion options for compliance.',
                        impact: 'low', tokens: 0, adoptionRate: 48, apiEndpoints: 6,
                        linkedFeatures: ['Gemini Memory API'], regions: ['Global']
                    },
                    { 
                        id: 'r10', provider: 'OpenAI', featureType: 'agent', date: '2024-05-10', 
                        feature: 'GPT-4 Assistants API', description: 'Agent platform with memory',
                        details: 'Assistants API with persistent memory across conversations. Integrated with ChatGPT, custom GPTs. 128K token memory.',
                        impact: 'high', tokens: 128000, adoptionRate: 55, apiEndpoints: 12,
                        linkedFeatures: ['ChatGPT', 'GPTs'], regions: ['Global']
                    },
                    { 
                        id: 'r11', provider: 'Microsoft', featureType: 'memory', date: '2024-05-20', 
                        feature: 'Memory Export API', description: 'Data portability feature',
                        details: 'New API for exporting memory data in standard formats (JSON, CSV). Supports GDPR compliance. Includes encryption options.',
                        impact: 'medium', tokens: 0, adoptionRate: 32, apiEndpoints: 4,
                        linkedFeatures: ['Copilot Memory'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r12', provider: 'Google', featureType: 'safety', date: '2024-06-01', 
                        feature: 'Memory Governance', description: 'Compliance controls',
                        details: 'Comprehensive governance controls for memory storage. Audit logs, access controls, content filtering. SOC 2 compliant.',
                        impact: 'high', tokens: 0, adoptionRate: 72, apiEndpoints: 8,
                        linkedFeatures: ['Gemini Memory API', 'Admin Console'], regions: ['Global']
                    },
                    { 
                        id: 'r13', provider: 'OpenAI', featureType: 'memory', date: '2024-08-05', 
                        feature: 'ChatGPT Org Memory', description: 'Organizational memory for ChatGPT workspaces',
                        details: 'Enables shared memory across teams within a ChatGPT workspace. Includes admin controls and export tools.',
                        impact: 'high', tokens: 150000, adoptionRate: 37, apiEndpoints: 10,
                        linkedFeatures: ['ChatGPT Teams', 'Assistant Memory API'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r14', provider: 'Microsoft', featureType: 'identity', date: '2024-09-12', 
                        feature: 'Edu Graph Binding', description: 'Education tenant identity binding',
                        details: 'Binds student and teacher identities more tightly to M365 Graph for EDU tenants, enabling cross-app memory defaults.',
                        impact: 'high', tokens: 0, adoptionRate: 41, apiEndpoints: 9,
                        linkedFeatures: ['M365 EDU', 'Copilot for Education'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r15', provider: 'Google', featureType: 'memory', date: '2025-02-18', 
                        feature: 'Classroom Long-Term Memory', description: 'Multi-year student memory in Classroom',
                        details: 'Retains multi-year learning trajectories for students, with educator-facing controls and retention policies.',
                        impact: 'high', tokens: 220000, adoptionRate: 29, apiEndpoints: 11,
                        linkedFeatures: ['Google Classroom', 'Workspace Graph'], regions: ['Global']
                    },
                    { 
                        id: 'r16', provider: 'Anthropic', featureType: 'api', date: '2025-06-03', 
                        feature: 'Claude Memory Webhooks', description: 'Event-driven memory integration',
                        details: 'Webhooks for memory read/write events, enabling external systems to sync or audit Claude memory activity.',
                        impact: 'medium', tokens: 0, adoptionRate: 18, apiEndpoints: 7,
                        linkedFeatures: ['Claude API', 'Audit Toolkit'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r17', provider: 'Anthropic', featureType: 'memory', date: '2024-10-20', 
                        feature: 'Claude EDU Memory Profiles', description: 'Education-focused memory profiles for Claude',
                        details: 'Allows institutions to define scoped memory profiles for different student cohorts, with strict retention and audit controls.',
                        impact: 'high', tokens: 160000, adoptionRate: 21, apiEndpoints: 8,
                        linkedFeatures: ['Claude EDU', 'Policy Toolkit'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r18', provider: 'Microsoft', featureType: 'safety', date: '2025-03-30', 
                        feature: 'Memory Risk Dashboard', description: 'Safety analytics for memory usage',
                        details: 'Dashboard for monitoring risky memory patterns across tenants, with exportable reports and automated policy suggestions.',
                        impact: 'medium', tokens: 0, adoptionRate: 33, apiEndpoints: 5,
                        linkedFeatures: ['Security Center', 'Copilot Memory'], regions: ['Global']
                    },
                    { 
                        id: 'r19', provider: 'OpenAI', featureType: 'api', date: '2025-09-01', 
                        feature: 'Memory Policy API', description: 'Programmatic control over memory retention and access',
                        details: 'API for setting per-tenant memory policies, including TTLs, scopes, export requirements, and jurisdictional constraints.',
                        impact: 'high', tokens: 0, adoptionRate: 19, apiEndpoints: 9,
                        linkedFeatures: ['Assistant Memory API', 'Compliance Toolkit'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r20', provider: 'Google', featureType: 'safety', date: '2024-07-10', 
                        feature: 'Student Memory Transparency Panel', description: 'Student-facing memory transparency tools',
                        details: 'Dashboard inside Classroom that shows students what the system remembers, with one-click deletion and export controls.',
                        impact: 'medium', tokens: 0, adoptionRate: 24, apiEndpoints: 4,
                        linkedFeatures: ['Google Classroom', 'Privacy Center'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r21', provider: 'Microsoft', featureType: 'memory', date: '2025-08-05', 
                        feature: 'Copilot Scenario Memory', description: 'Task- and scenario-scoped memories',
                        details: 'Allows tenants to define scenario-specific memories (e.g., IEP planning, grading) with strict boundaries and retention rules.',
                        impact: 'high', tokens: 180000, adoptionRate: 23, apiEndpoints: 6,
                        linkedFeatures: ['M365 EDU', 'Copilot Memory'], regions: ['Global']
                    },
                    { 
                        id: 'r22', provider: 'Google', featureType: 'agent', date: '2024-07-22', 
                        feature: 'Gemini Classroom Coach', description: 'In-class agent powered by Classroom memory',
                        details: 'Context-aware coach for teachers that uses Classroom memory to suggest interventions and resources in real time.',
                        impact: 'high', tokens: 0, adoptionRate: 26, apiEndpoints: 9,
                        linkedFeatures: ['Google Classroom', 'Gemini Memory API'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r23', provider: 'Microsoft', featureType: 'agent', date: '2024-10-05', 
                        feature: 'Teams EDU Memory Assistant', description: 'Meeting assistant with EDU memory context',
                        details: 'Captures and summarizes EDU-specific meetings (IEP, PLC, department planning) with memory-aware action items.',
                        impact: 'high', tokens: 0, adoptionRate: 28, apiEndpoints: 8,
                        linkedFeatures: ['Teams', 'Copilot Memory'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r24', provider: 'OpenAI', featureType: 'safety', date: '2025-01-30', 
                        feature: 'Memory Compliance Scanner', description: 'Automated scanning of memory for policy violations',
                        details: 'Scans tenant memory stores for policy violations and PII exposure, with remediation workflows and alerts.',
                        impact: 'medium', tokens: 0, adoptionRate: 20, apiEndpoints: 6,
                        linkedFeatures: ['Memory Policy API', 'Compliance Toolkit'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r25', provider: 'Anthropic', featureType: 'identity', date: '2025-04-18', 
                        feature: 'Claude EDU Identity Bridge', description: 'Bridge between district identity and Claude memory',
                        details: 'Lightweight identity bridge that links district accounts to Claude memory with explicit consent flows and per-role scopes.',
                        impact: 'medium', tokens: 0, adoptionRate: 17, apiEndpoints: 5,
                        linkedFeatures: ['Claude EDU', 'Identity Bridge'], regions: ['US']
                    },
                    { 
                        id: 'r26', provider: 'Google', featureType: 'memory', date: '2025-09-12', 
                        feature: 'Workspace Memory Snapshots', description: 'Periodic snapshots of memory state for audit and rollback',
                        details: 'Creates periodic snapshots of Workspace memory to support auditing, rollback, and research on longitudinal learning patterns.',
                        impact: 'high', tokens: 260000, adoptionRate: 16, apiEndpoints: 7,
                        linkedFeatures: ['Workspace Graph', 'Admin Console'], regions: ['Global']
                    },
                    { 
                        id: 'r27', provider: 'OpenAI', featureType: 'memory', date: '2024-07-28', 
                        feature: 'Tutor Session Memory', description: 'Session-scoped memory for tutoring scenarios',
                        details: 'Stores multi-session tutoring context for students using ChatGPT-based tutors, with clear session boundaries and expiration.',
                        impact: 'high', tokens: 120000, adoptionRate: 22, apiEndpoints: 6,
                        linkedFeatures: ['ChatGPT Tutors', 'Assistant Memory API'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r28', provider: 'Microsoft', featureType: 'api', date: '2024-11-09', 
                        feature: 'Memory Insights API', description: 'API for querying memory usage analytics',
                        details: 'Provides aggregated insights about memory usage patterns across workloads, including EDU-specific metrics.',
                        impact: 'medium', tokens: 0, adoptionRate: 19, apiEndpoints: 8,
                        linkedFeatures: ['Memory Risk Dashboard', 'Security Center'], regions: ['Global']
                    },
                    { 
                        id: 'r29', provider: 'Anthropic', featureType: 'safety', date: '2025-02-22', 
                        feature: 'Claude Memory Red-Team Reports', description: 'Red-team analysis of memory behavior',
                        details: 'Publishes periodic red-team reports on memory misuse and mitigations, with hooks for policy updates.',
                        impact: 'medium', tokens: 0, adoptionRate: 14, apiEndpoints: 3,
                        linkedFeatures: ['Claude API', 'Policy Toolkit'], regions: ['US', 'EU']
                    },
                    { 
                        id: 'r30', provider: 'Google', featureType: 'identity', date: '2025-07-03', 
                        feature: 'Guardian Consent Flows', description: 'Consent and override flows for student memory',
                        details: 'Introduces guardian and district consent flows that gate which student memories can be persisted and for how long.',
                        impact: 'high', tokens: 0, adoptionRate: 27, apiEndpoints: 5,
                        linkedFeatures: ['Privacy Center', 'Workspace Graph'], regions: ['US']
                    },
                    { 
                        id: 'r31', provider: 'OpenAI', featureType: 'agent', date: '2025-10-05', 
                        feature: 'Advisor Memory Packs', description: 'Pre-configured memory packs for advising scenarios',
                        details: 'Advising-focused memory packs (college counseling, career pathways) managed as modular units that can be enabled per institution.',
                        impact: 'high', tokens: 140000, adoptionRate: 18, apiEndpoints: 7,
                        linkedFeatures: ['Advisor Agents', 'Memory Policy API'], regions: ['US', 'EU']
                    }
                ],
                memoryGrowthByYear: {
                    2023: { total: 7, byProvider: { Google: 2, Microsoft: 2, OpenAI: 2, Anthropic: 1 } },
                    2024: { total: 9, byProvider: { Google: 2, Microsoft: 3, OpenAI: 3, Anthropic: 1 } },
                    2025: { total: 16, byProvider: { Google: 2, Microsoft: 3, OpenAI: 4, Anthropic: 7 } }
                },
                memoryProductsByYear: {
                    2023: [
                        { provider: 'Google', product: 'Bard', date: '2023-01-15', description: 'Bard gains a Memory toggle remembering user facts (diet, kids, preferences) with add/delete controls.', category: 'User memory', source: 'AndroidPolice', sourceUrl: 'https://www.androidpolice.com/google-bard-memory-toggle-remember-user-details/' },
                        { provider: 'Microsoft', product: 'Bing Chat in Edge', date: '2023-02-15', description: 'Persistent chat history enabling reuse of past queries as context.', category: 'Conversation memory', source: 'CNBC', sourceUrl: 'https://www.cnbc.com/2023/05/04/microsoft-removes-bing-waiting-list-and-adds-chat-history.html' },
                        { provider: 'OpenAI', product: 'Assistants API / Threads', date: '2023-03-15', description: 'Threads store multi-turn conversation state for agents automatically.', category: 'Developer memory', source: 'Wired (DevDay)', sourceUrl: 'https://www.wired.com/story/chatgpt-memory-openai/' },
                        { provider: 'Anthropic', product: 'Claude 2', date: '2023-04-15', description: '100K-token long context for extended in-session reasoning; not persistent.', category: 'Long context', source: 'Anthropic', sourceUrl: 'https://www.anthropic.com/news/100k-context-windows' },
                        { provider: 'OpenAI', product: 'GPT-4 / ChatGPT', date: '2023-05-15', description: 'Large context windows (8K→32K) but no persistent memory.', category: 'Long context', source: 'OpenAI', sourceUrl: 'https://openai.com' },
                        { provider: 'Google', product: 'Bard', date: '2023-06-15', description: 'Contextual recall only within a single session.', category: 'Session-only', source: 'Google Bard', sourceUrl: 'https://bard.google.com' },
                        { provider: 'Microsoft', product: 'Copilot', date: '2023-07-15', description: 'Stateless assistant; session-only memory.', category: 'Session-only', source: 'Microsoft', sourceUrl: 'https://www.microsoft.com' }
                    ],
                    2024: [
                        { provider: 'Google', product: 'Gemini Chatbot', date: '2024-01-15', description: 'Gemini now has memory; remembers user info/preferences across sessions (opt-in).', category: 'Persistent memory', source: 'TechCrunch', sourceUrl: 'https://techcrunch.com/2024/11/19/googles-gemini-chatbot-now-has-memory/' },
                        { provider: 'Google', product: 'Gemini LLM', date: '2024-02-15', description: 'Long-context window supports more extensive reasoning within a session.', category: 'Extended short-term context', source: 'Google Dev Docs', sourceUrl: 'https://ai.google.dev/gemini-api/docs/long-context' },
                        { provider: 'Microsoft', product: 'Microsoft Copilot (General)', date: '2024-03-15', description: 'Microsoft Copilot begins rolling out deeper "contextual understanding" features tied to Microsoft Graph, enabling Copilot to recall documents, emails, meetings, and user context stored in Microsoft 365', category: 'Graph-backed contextual memory (organizational memory; not user-profile memory)', source: 'Demonstrated broadly at Build & Ignite as "Copilot understands your work context"', sourceUrl: 'https://blogs.microsoft.com/blog/tag/microsoft-build' },
                        { provider: 'Microsoft', product: 'Microsoft 365 Copilot', date: '2024-04-15', description: 'Introduces cross-app context abilities — Copilot can remember content across Outlook, Teams, SharePoint, and Word because of Microsoft Graph unification', category: 'Enterprise graph memory (system-level persistent context)', source: '"Copilot understands the context across your apps" (Ignite 2024)', sourceUrl: 'https://techcommunity.microsoft.com/blog/microsoft365copilotblog/microsoft-365-copilot--microsoft-ignite-2024-event-guide/4298855' },
                        { provider: 'Microsoft', product: 'SharePoint Copilot Agents (GA)', date: '2024-05-15', description: 'SharePoint Agents can store and retrieve site-specific knowledge, documents, and prior user interactions — representing an enterprise-level persistent memory', category: 'Agent-level persistent memory (enterprise graph)', source: 'SharePoint Agents GA announcement', sourceUrl: 'https://techcommunity.microsoft.com/blog/microsoft365copilotblog/ignite-2024-sharepoint-agents-now-in-general-availability/4298746' },
                        { provider: 'OpenAI', product: 'ChatGPT Memory Launch (Feb)', date: '2024-06-15', description: 'Memory + controls: saved preferences, editable memory log.', category: 'Opt-in persistent', source: 'OpenAI', sourceUrl: 'https://openai.com/index/memory-and-new-controls-for-chatgpt/' },
                        { provider: 'OpenAI', product: 'Memory Wider Rollout (Apr)', date: '2024-07-15', description: 'Memory expands to Plus subscribers.', category: 'Cross-session memory', source: 'WIRED', sourceUrl: 'https://www.wired.com/story/how-to-use-chatgpt-memory-feature/' },
                        { provider: 'OpenAI', product: 'Memory to All Tiers (Sept)', date: '2024-08-15', description: 'Memory available to Free/Plus/Team/Enterprise; full UI controls.', category: 'Broad persistent memory', source: 'OpenAI', sourceUrl: 'https://openai.com/index/memory-and-new-controls-for-chatgpt/' },
                        { provider: 'Anthropic', product: 'Claude 3 Models', date: '2024-09-15', description: 'Improved long-context & Artifacts; no persistent memory yet.', category: 'Long context', source: 'Anthropic', sourceUrl: 'https://www.anthropic.com' }
                    ],
                    2025: [
                        { provider: 'Google', product: 'Vertex AI Memory Bank', date: '2025-01-15', description: 'Persistent long-term memory for agents (facts, history, preferences).', category: 'Agent persistent memory', source: 'Google Cloud', sourceUrl: 'https://cloud.google.com/blog/products/ai-machine-learning/vertex-ai-memory-bank-in-public-preview' },
                        { provider: 'Google', product: 'Gemini "Personal Context"', date: '2025-02-15', description: 'Auto-recall of conversations & preferences; default ON (opt-out).', category: 'Persistent personalization memory', source: 'The Verge', sourceUrl: 'https://www.theverge.com/news/758624/google-gemini-ai-automatic-memory-privacy-update' },
                        { provider: 'Microsoft', product: 'Security Copilot Agents', date: '2025-03-15', description: 'Enables persistent threat-analysis memory: agents maintain knowledge of organizational security posture, incidents, and prior analyses', category: 'Domain-specific persistent memory (security posture memory)', source: 'Microsoft announces 11 new Security Copilot agents (2025)', sourceUrl: 'https://www.microsoft.com/en-us/microsoft-365/blog/2025/11/18/microsoft-ignite-2025-copilot-and-agents-built-to-power-the-frontier-firm/' },
                        { provider: 'Microsoft', product: 'Copilot Studio Memory Layer', date: '2025-04-15', description: 'New capabilities allow developers to add persistent memory to custom Copilot agents — storing user preferences, prior interactions, or workflow state', category: 'Developer-defined agent memory (persistent)', source: 'Copilot Studio updates (2025 release cycle)', sourceUrl: 'https://learn.microsoft.com/microsoft-copilot-studio' },
                        { provider: 'Microsoft', product: 'Microsoft Graph Improvements', date: '2025-05-15', description: 'Graph evolves into a "unified organizational memory" — powering Copilot\'s ability to recall meeting summaries, files, chat history, and prior tasks', category: 'Organizational persistent memory', source: 'Repeatedly emphasized across 2024–2025 product releases', sourceUrl: 'https://learn.microsoft.com/graph/overview' },
                        { provider: 'OpenAI', product: 'Responses API', date: '2025-06-15', description: 'Workflow/task memory for agents (state retention).', category: 'Workflow memory', source: 'OpenAI', sourceUrl: 'https://openai.com/index/new-tools-for-building-agents' },
                        { provider: 'OpenAI', product: 'ChatGPT Pro Enhanced Memory', date: '2025-07-15', description: 'Deeper long-term personalization (tone, habits, projects).', category: 'Cross-session memory', source: 'OpenAI Blog', sourceUrl: 'https://openai.com/blog' },
                        { provider: 'OpenAI', product: 'Agent Platform', date: '2025-08-15', description: 'Autonomous agents with persistent tool state & structured memory.', category: 'Agent-level memory', source: 'OpenAI Platform', sourceUrl: 'https://platform.openai.com' },
                        { provider: 'OpenAI', product: 'Retrieval & Vector Store', date: '2025-09-15', description: 'Long-term vector memory for documents & user knowledge bases.', category: 'Externalized memory', source: 'Retrieval API', sourceUrl: 'https://platform.openai.com/docs/guides/retrieval' },
                        { provider: 'Anthropic', product: 'Claude 4 Models (Opus / Sonnet)', date: '2025-10-15', description: 'Introduces enhanced memory functions, including creation and referencing of memory files for long-running tasks and document workflows.', category: 'Extended session context / file-based memory', source: 'Launch coverage highlighting improved memory and memory-file behavior.', sourceUrl: 'https://www.anthropic.com/news/claude-4' },
                        { provider: 'Anthropic', product: '"Search and reference chats"', date: '2025-11-15', description: 'Claude can search across previous chats and surface relevant context in new conversations through retrieval—not true persistent memory.', category: 'Cross-chat retrieval (RAG over chat history)', source: 'Feature described as past chat search/continuation, not persistent memory.', sourceUrl: 'https://support.claude.com/en/articles/11817273-using-claude-s-chat-search-and-memory-to-build-on-previous-context' },
                        { provider: 'Anthropic', product: 'Claude Memory for Teams (project-scoped)', date: '2025-12-15', description: 'Team-focused memory: Claude remembers projects, processes, and client needs with scoped memories and optional incognito/no-memory mode.', category: 'Project-scoped persistent memory (Teams/Enterprise)', source: '"Bringing memory to teams at work" blog + industry coverage.', sourceUrl: 'https://www.anthropic.com/news/memory' },
                        { provider: 'Anthropic', product: 'Persistent Memory (Teams/Enterprise)', date: '2025-01-15', description: 'Gains persistent memory across sessions—remembers projects and preferences with granular controls and privacy options.', category: 'Cross-session persistent memory (enterprise-focused)', source: 'Update describing persistent memory and controls.', sourceUrl: 'https://www.reworked.co/digital-workplace/claude-ai-gains-persistent-memory-in-latest-anthropic-update/' },
                        { provider: 'Anthropic', product: 'Optional Memory for Max/Team/Enterprise', date: '2025-02-15', description: 'Opt-in memory: Claude can recall past conversations when enabled; default remains stateless for privacy.', category: 'Opt-in persistent memory', source: 'Coverage emphasizing privacy-first, opt-in design.', sourceUrl: 'https://www.techradar.com/ai-platforms-assistants/claude/you-can-now-give-claude-access-to-memories-of-previous-conversations-but-only-if-you-want-to' },
                        { provider: 'Anthropic', product: 'Automatic Memory for Teams/Enterprise', date: '2025-03-15', description: 'Automatic memory enables Claude to recall preferences and project context without explicit prompts; users can edit or disable stored memories.', category: 'Automatic cross-session persistent memory', source: 'Verge coverage of automatic memory upgrade and incognito mode.', sourceUrl: 'https://www.theverge.com/news/776827/anthropic-claude-ai-memory-upgrade-team-enterprise' },
                        { provider: 'Anthropic', product: 'Memory for All Paid Users', date: '2025-04-15', description: 'Rolls out persistent, project-based memory to all paid customers (Pro, Max, Team, Enterprise), including import/export support for portability.', category: 'Broad rollout of persistent, project-based memory', source: 'Coverage noting expansion and project-based memory spaces.', sourceUrl: 'https://www.macrumors.com/2025/10/23/anthropic-automatic-memory-claude/' }
                    ]
                },
                agentFeatures: [
                    { provider: 'Google', q1: 0, q2: 1, q3: 0, q4: 3 },
                    { provider: 'Microsoft', q1: 3, q2: 1, q3: 1, q4: 2 },
                    { provider: 'OpenAI', q1: 2, q2: 1, q3: 1, q4: 1 },
                    { provider: 'Anthropic', q1: 0, q2: 0, q3: 2, q4: 1 }
                ],
                identityExpansions: {
                    Google: { workspace: 8, graph: 12, account: 6 },
                    Microsoft: { workspace: 10, graph: 9, account: 8 },
                    OpenAI: { workspace: 6, graph: 8, account: 7 },
                    Anthropic: { workspace: 4, graph: 5, account: 6 }
                },
                alerts: [
                    { type: 'spike', severity: 'high', title: 'Memory Release Spike', message: '3+ memory-related releases detected in Q1 2025', date: '2025-03-15' },
                    { type: 'convergence', severity: 'medium', title: 'Feature Convergence', message: 'Multiple providers launched similar agent features within 45 days', date: '2025-02-20' },
                    { type: 'identity', severity: 'high', title: 'Identity Creep Detected', message: 'New capabilities binding to Workspace/Graph contexts', date: '2025-04-15' }
                ]
            },
            memory: {
                providers: [
                    {
                        name: 'Google',
                        lockInIndex: 75,
                        opennessScore: 25,
                        recallDepth: 128000,
                        boundariesScore: 40,
                        crossAppReach: 12,
                        defaultOnRate: 85,
                        visibilityIndex: 30,
                        apps: ['Gmail', 'Docs', 'Classroom', 'Calendar', 'Keep', 'Drive', 'Sheets', 'Slides', 'Meet', 'Chat', 'Search', 'Photos']
                    },
                    {
                        name: 'Microsoft',
                        lockInIndex: 50,
                        opennessScore: 60,
                        recallDepth: 200000,
                        boundariesScore: 50,
                        crossAppReach: 15,
                        defaultOnRate: 90,
                        visibilityIndex: 35,
                        apps: ['Outlook', 'Word', 'Excel', 'PowerPoint', 'Teams', 'OneNote', 'OneDrive', 'SharePoint', 'Planner', 'To-Do', 'Calendar', 'Forms', 'Sway', 'Yammer', 'Stream']
                    },
                    {
                        name: 'OpenAI',
                        lockInIndex: 60,
                        opennessScore: 45,
                        recallDepth: 128000,
                        boundariesScore: 55,
                        crossAppReach: 8,
                        defaultOnRate: 90,
                        visibilityIndex: 45,
                        apps: ['ChatGPT', 'GPTs', 'API', 'Plugins', 'Assistants', 'DALL·E', 'Whisper', 'Code Interpreter']
                    },
                    {
                        name: 'Anthropic',
                        lockInIndex: 35,
                        opennessScore: 70,
                        recallDepth: 200000,
                        boundariesScore: 60,
                        crossAppReach: 6,
                        defaultOnRate: 75,
                        visibilityIndex: 50,
                        apps: ['Claude', 'API', 'Console', 'Workbench', 'Messaging', 'Tools']
                    }
                ],
                recallDepthHistory: [
                    { model: 'GPT-3.5 Turbo', date: '2023-03', depth: 10000 },
                    { model: 'GPT-4', date: '2023-03', depth: 25000 },
                    { model: 'GPT-4 Turbo', date: '2023-11', depth: 75000 },
                    { model: 'GPT-4o', date: '2024-05', depth: 90000 },
                    { model: 'Claude 2', date: '2023-07', depth: 90000 },
                    { model: 'Claude 2.1', date: '2023-11', depth: 135000 },
                    { model: 'Claude 3 Opus', date: '2024-03', depth: 190000 },
                    { model: 'Claude 3 Sonnet', date: '2024-03', depth: 165000 },
                    { model: 'Gemini Pro 1.0', date: '2023-12', depth: 25000 },
                    { model: 'Gemini 1.5 Flash', date: '2024-02', depth: 300000 },
                    { model: 'Gemini 1.5 Pro', date: '2024-02', depth: 650000 },
                    { model: 'Copilot (GPT-4 Turbo)', date: '2023-12', depth: 75000 },
                    { model: 'Copilot (GPT-4o)', date: '2024-05', depth: 90000 },
                    { model: 'Phi-3 Medium', date: '2024-04', depth: 45000 },
                    { model: 'Phi-3 Mini', date: '2024-04', depth: 30000 },
                    { model: 'Phi-3 Small', date: '2024-04', depth: 22500 },
                    { model: 'LongRoPE (research)', date: '2024-01', depth: 650000 }
                ],
                identityLockIn: [
                    { 
                        provider: 'Google', 
                        percentage: 75, 
                        description: 'Gemini + Workspace memory features tightly bound to Google identity',
                        details: 'Memory and context features (Gemini Memory, Workspace Graph) require Google accounts and Workspace identity, driving high lock-in. Lowest openness, highest lock-in.',
                        category: 'Maximum Risk'
                    },
                    { 
                        provider: 'Microsoft', 
                        percentage: 50, 
                        description: 'Copilot capabilities rely on Microsoft Graph identity',
                        details: 'Microsoft Graph identity system is deeply integrated with Copilot memory, enabling cross-app personalization but creating moderate lock-in dependencies. Medium-high openness, medium lock-in.',
                        category: 'Limited but Manageable'
                    },
                    { 
                        provider: 'OpenAI', 
                        percentage: 60, 
                        description: 'Memory features tied to ChatGPT account/workspace',
                        details: 'ChatGPT account and workspace identities enable persistent memory across conversations and custom GPTs, with medium-high identity binding. Medium openness, high-ish lock-in.',
                        category: 'Limited but Manageable'
                    },
                    { 
                        provider: 'Anthropic', 
                        percentage: 35, 
                        description: 'Tied to Claude organizational workspaces',
                        details: 'Claude organizational workspaces enable team-level memory and context sharing, with comparatively lower identity binding and more openness. High openness, low lock-in.',
                        category: 'Opportunity Zone'
                    }
                ],
                alerts: [
                    { type: 'default-on', severity: 'high', title: 'Memory Default-On Change', message: 'Microsoft changed memory to default-on for EDU accounts', date: '2025-05-01' },
                    { type: 'cross-app', severity: 'medium', title: 'New Cross-App Memory Integration', message: 'Google integrated Classroom memory with Workspace Graph', date: '2025-04-10' },
                    { type: 'recall-depth', severity: 'high', title: 'Major Recall Depth Increase', message: 'Claude-3 increased recall depth to 200K tokens', date: '2025-03-01' }
                ]
            },
        };

        // Helper function to create collapsible rationale section
        function createCollapsibleRationale(container, htmlContent, title = 'Why This Chart Matters') {
            const rationale = container.appendChild(document.createElement('div'));
            rationale.className = 'chart-rationale';
            
            const header = rationale.appendChild(document.createElement('div'));
            header.className = 'chart-rationale-header';
            
            const titleDiv = header.appendChild(document.createElement('div'));
            titleDiv.className = 'chart-rationale-header-title';
            titleDiv.textContent = title;
            
            const controlDiv = header.appendChild(document.createElement('div'));
            controlDiv.className = 'chart-rationale-header-control';
            
            const icon = controlDiv.appendChild(document.createElement('span'));
            icon.className = 'chart-rationale-header-icon';
            icon.textContent = '▶';
            
            const text = controlDiv.appendChild(document.createElement('span'));
            text.textContent = 'Click to expand';
            
            const contentWrapper = rationale.appendChild(document.createElement('div'));
            contentWrapper.className = 'chart-rationale-content-wrapper';
            contentWrapper.innerHTML = htmlContent;
            
            header.onclick = function() {
                const isExpanded = contentWrapper.classList.contains('expanded');
                if (isExpanded) {
                    contentWrapper.classList.remove('expanded');
                    icon.textContent = '▶';
                    text.textContent = 'Click to expand';
                } else {
                    contentWrapper.classList.add('expanded');
                    icon.textContent = '▼';
                    text.textContent = 'Click to collapse';
                }
            };
            
            return rationale;
        }

        // Module navigation
        function showModule(moduleName) {
            // Hide all modules
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.module-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show only the selected module
            const moduleElement = document.getElementById(`module-${moduleName}`);
            if (moduleElement) {
                moduleElement.classList.add('active');
                
                // Activate the clicked button
                document.querySelectorAll('.module-btn').forEach(btn => {
                    if (btn.getAttribute('onclick').includes(`'${moduleName}'`)) {
                        btn.classList.add('active');
                    }
                });
                
                // Render the selected module
                if (moduleName === 'ecosystem') {
                    renderEcosystemModule();
                } else if (moduleName === 'memory') {
                    renderMemoryModule();
                }
                
                // Scroll to the module section
                setTimeout(() => {
                    moduleElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
        }

        // Module 1: Ecosystem Moves
        function renderEcosystemModule() {
            renderEcosystemAlerts();
            renderMemoryGrowthChart();
            renderAgentVelocity();
        }

        function renderEcosystemAlerts() {
            const container = document.getElementById('ecosystemAlerts');
            const alerts = dashboardData.ecosystem.alerts;
            
            container.innerHTML = '<div style="font-weight: 700; color: #e2e8f0; margin-bottom: 15px;">Smart Alerts</div>';
            
            alerts.forEach(alert => {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert-item ${alert.severity === 'high' ? '' : alert.severity === 'medium' ? 'warning' : 'info'}`;
                alertDiv.innerHTML = `
                    <div class="alert-title">${alert.title}</div>
                    <div class="alert-message">${alert.message} - ${alert.date}</div>
                `;
                container.appendChild(alertDiv);
            });
        }

        function renderMemoryGrowthChart() {
            const container = document.getElementById('ecosystemMemoryGrowthChart');
            const width = container.parentElement.clientWidth - 50;
            const height = 450;
            const margin = { top: 40, right: 30, bottom: 80, left: 80 };

            container.innerHTML = '';

            // Create tooltip
            const tooltip = d3.select(container).append('div')
                .attr('class', 'tooltip')
                .style('opacity', 0);

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            const data = dashboardData.ecosystem.memoryGrowthByYear;
            const years = [2023, 2024, 2025];
            const providers = ['Google', 'Microsoft', 'OpenAI', 'Anthropic'];
            const colorScale = d3.scaleOrdinal()
                .domain(providers)
                .range(['#4285f4', '#00a4ef', '#ff6b35', '#d4a574']);

            // Prepare data for grouped bars
            const barData = years.map(year => ({
                year,
                total: data[year].total,
                providers: providers.map(provider => ({
                    provider,
                    value: data[year].byProvider[provider] || 0
                }))
            }));

            const xScale = d3.scaleBand()
                .domain(years)
                .range([0, chartWidth])
                .padding(0.2);

            const maxValue = d3.max(barData, d => d.total);
            const yScale = d3.scaleLinear()
                .domain([0, maxValue * 1.15])
                .range([chartHeight, 0]);

            // Grouped bars
            const barWidth = xScale.bandwidth() / providers.length;

            barData.forEach((yearData, yearIdx) => {
                yearData.providers.forEach((providerData, pIdx) => {
                    const x = xScale(yearData.year) + pIdx * barWidth;
                    const barHeight = chartHeight - yScale(providerData.value);
                    
                    const bar = g.append('rect')
                        .attr('x', x)
                        .attr('y', yScale(providerData.value))
                        .attr('width', barWidth - 2)
                        .attr('height', barHeight)
                        .attr('fill', colorScale(providerData.provider))
                        .attr('rx', 4)
                        .attr('cursor', 'pointer')
                        .style('opacity', 0.85);

                    // Value labels on bars
                    if (providerData.value > 0) {
                        g.append('text')
                            .attr('x', x + barWidth / 2)
                            .attr('y', yScale(providerData.value) - 5)
                            .attr('text-anchor', 'middle')
                            .attr('fill', '#e2e8f0')
                            .attr('font-size', '10px')
                            .attr('font-weight', '600')
                            .text(providerData.value);
                    }

                    // Tooltip
                    bar.on('mouseover', function(event) {
                        const growth2023to2025 = yearData.year === 2025 ? 
                            ((data[2025].byProvider[providerData.provider] - data[2023].byProvider[providerData.provider]) / Math.max(data[2023].byProvider[providerData.provider], 1) * 100) : 0;
                        const totalGrowth2023to2025 = ((data[2025].total - data[2023].total) / data[2023].total * 100);
                        
                        tooltip.transition().duration(200).style('opacity', 1);
                        tooltip.html(`
                            <div class="tooltip-title">${providerData.provider} - ${yearData.year}</div>
                            <div class="tooltip-item"><strong>Memory Releases:</strong> ${providerData.value}</div>
                            <div class="tooltip-item"><strong>Year Total:</strong> ${yearData.total} releases</div>
                            ${yearData.year === 2025 ? `<div class="tooltip-item"><strong>Growth (2023→2025):</strong> ${growth2023to2025 > 0 ? '+' : ''}${growth2023to2025.toFixed(0)}%</div>` : ''}
                            ${yearData.year === 2023 ? `<div class="tooltip-item" style="font-size: 0.8rem; color: #667eea; margin-top: 8px;">Baseline year - foundation for memory ecosystem</div>` : ''}
                            ${yearData.year === 2025 ? `<div class="tooltip-item" style="font-size: 0.8rem; color: #e53e3e; margin-top: 8px;">⚠ ${totalGrowth2023to2025.toFixed(0)}% total growth indicates accelerating lock-in risk</div>` : ''}
                        `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                        
                        bar.style('opacity', 1);
                    })
                    .on('mouseout', function() {
                        tooltip.transition().duration(200).style('opacity', 0);
                        bar.style('opacity', 0.85);
                    });
                });
            });

            // Total labels above bars
            barData.forEach(yearData => {
                const x = xScale(yearData.year) + xScale.bandwidth() / 2;
                g.append('text')
                    .attr('x', x)
                    .attr('y', yScale(yearData.total) - 10)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#e2e8f0')
                    .attr('font-size', '14px')
                    .attr('font-weight', '700')
                    .text(yearData.total);
            });

            // Growth annotation
            const growth2023to2025 = ((data[2025].total - data[2023].total) / data[2023].total * 100);
            g.append('line')
                .attr('x1', xScale(2023))
                .attr('y1', yScale(data[2023].total) - 25)
                .attr('x2', xScale(2025))
                .attr('y2', yScale(data[2025].total) - 25)
                .attr('stroke', '#48bb78')
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '5,5');

            g.append('text')
                .attr('x', (xScale(2023) + xScale(2025)) / 2)
                .attr('y', yScale(data[2025].total) - 35)
                .attr('text-anchor', 'middle')
                .attr('fill', '#48bb78')
                .attr('font-size', '13px')
                .attr('font-weight', '700')
                .text('+130% Growth');

            // Highlight 2024-2025 jump
            const jump2024to2025 = ((data[2025].total - data[2024].total) / data[2024].total * 100);
            g.append('rect')
                .attr('x', xScale(2024) - 5)
                .attr('y', 0)
                .attr('width', xScale.bandwidth() + 10)
                .attr('height', chartHeight)
                .attr('fill', 'rgba(102, 126, 234, 0.05)')
                .attr('stroke', '#667eea')
                .attr('stroke-width', 1)
                .attr('stroke-dasharray', '3,3')
                .style('pointer-events', 'none');

            g.append('text')
                .attr('x', xScale(2025) + xScale.bandwidth() / 2)
                .attr('y', chartHeight - 20)
                .attr('text-anchor', 'middle')
                .attr('fill', '#ffffff')
                .attr('font-size', '11px')
                .attr('font-weight', '600')
                .text(`83% jump from 2024`);

            // Axes
            g.append('g')
                .attr('transform', `translate(0,${chartHeight})`)
                .call(d3.axisBottom(xScale))
                .selectAll('text')
                .attr('fill', '#a0aec0')
                .style('font-size', '12px');

            g.append('g')
                .call(d3.axisLeft(yScale).ticks(8))
                .selectAll('text')
                .attr('fill', '#a0aec0')
                .style('font-size', '11px');

            // Axis labels
            g.append('text')
                .attr('x', chartWidth / 2)
                .attr('y', chartHeight + 50)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .text('Year');

            g.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', -60)
                .attr('x', -chartHeight / 2)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .text('Number of Memory-Related Releases');

            // Legend
            const legend = container.appendChild(document.createElement('div'));
            legend.className = 'chart-legend';
            providers.forEach(provider => {
                const total = data[2023].byProvider[provider] + data[2024].byProvider[provider] + data[2025].byProvider[provider];
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="legend-color" style="background: ${colorScale(provider)}"></div>
                    <div class="legend-text">${provider} (${total} total)</div>
                `;
                legend.appendChild(item);
            });

            // Info panel
            const infoPanel = container.appendChild(document.createElement('div'));
            infoPanel.className = 'chart-info';
            infoPanel.innerHTML = `
                <strong>Chart Details:</strong> Growth of memory-related product releases by provider from 2023 to 2025. 
                Total releases: <strong>${data[2023].total} in 2023</strong> → <strong>${data[2024].total} in 2024</strong> → <strong>${data[2025].total} in 2025</strong>. 
                This represents a <strong>~130% increase</strong> from 2023 to 2025, indicating accelerating investment in memory infrastructure.
            `;

            // Product Breakdown Section (Collapsible)
            const breakdownSection = container.appendChild(document.createElement('div'));
            breakdownSection.style.cssText = 'margin-top: 20px; background: #1a202c; border: 2px solid #4a5568; border-radius: 12px; padding: 15px;';
            
            const breakdownHeader = breakdownSection.appendChild(document.createElement('div'));
            breakdownHeader.style.cssText = 'cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: space-between; padding: 10px 12px; background: #2d3748; border-radius: 6px; margin-bottom: 0; transition: all 0.3s ease; border: 1px solid #4a5568;';
            breakdownHeader.onmouseenter = function() {
                breakdownHeader.style.background = '#3d4758';
                breakdownHeader.style.borderColor = '#667eea';
            };
            breakdownHeader.onmouseleave = function() {
                breakdownHeader.style.background = '#2d3748';
                breakdownHeader.style.borderColor = '#4a5568';
            };
            breakdownHeader.onclick = function() {
                const isCollapsed = breakdownContent.style.display === 'none';
                breakdownContent.style.display = isCollapsed ? 'block' : 'none';
                expandIcon.textContent = isCollapsed ? '▼' : '▶';
                expandText.textContent = isCollapsed ? 'Click to collapse' : 'Click to expand';
                breakdownHeader.style.marginBottom = isCollapsed ? '15px' : '0';
            };
            
            const breakdownTitle = breakdownHeader.appendChild(document.createElement('div'));
            breakdownTitle.style.cssText = 'font-size: 0.95rem; font-weight: 700; color: #667eea; display: flex; align-items: center; gap: 8px;';
            breakdownTitle.innerHTML = '<span>Product Breakdown: How Each Memory Product is Counted</span>';
            
            const expandControl = breakdownHeader.appendChild(document.createElement('div'));
            expandControl.style.cssText = 'display: flex; align-items: center; gap: 8px; font-size: 0.75rem; color: #a0aec0;';
            
            const expandIcon = expandControl.appendChild(document.createElement('span'));
            expandIcon.style.cssText = 'font-size: 0.9rem; color: #667eea; font-weight: 700;';
            expandIcon.textContent = '▶';
            
            const expandText = expandControl.appendChild(document.createElement('span'));
            expandText.textContent = 'Click to expand';
            
            const breakdownContent = breakdownSection.appendChild(document.createElement('div'));
            breakdownContent.style.cssText = 'display: none;'; // Collapsed by default

            const productsData = dashboardData.ecosystem.memoryProductsByYear;
            const breakdownYears = [2023, 2024, 2025];

            breakdownYears.forEach(year => {
                const yearSection = breakdownContent.appendChild(document.createElement('div'));
                yearSection.style.cssText = 'margin-bottom: 18px;';
                
                const yearHeader = yearSection.appendChild(document.createElement('div'));
                yearHeader.style.cssText = 'font-size: 0.9rem; font-weight: 700; color: #e2e8f0; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;';
                yearHeader.innerHTML = `
                    <span>${year}</span>
                    <span style="font-size: 0.75rem; color: #667eea; font-weight: 600;">(${productsData[year].length} products)</span>
                `;

                // Group by provider
                const byProvider = {};
                productsData[year].forEach(product => {
                    if (!byProvider[product.provider]) {
                        byProvider[product.provider] = [];
                    }
                    byProvider[product.provider].push(product);
                });

                Object.keys(byProvider).forEach(provider => {
                    const providerSection = yearSection.appendChild(document.createElement('div'));
                    providerSection.style.cssText = 'margin-bottom: 12px; padding: 10px; background: #2d3748; border-radius: 6px; border-left: 3px solid ' + colorScale(provider) + ';';
                    
                    const providerHeader = providerSection.appendChild(document.createElement('div'));
                    providerHeader.style.cssText = 'font-weight: 700; color: #e2e8f0; margin-bottom: 8px; font-size: 0.85rem;';
                    providerHeader.textContent = `${provider} (${byProvider[provider].length} product${byProvider[provider].length > 1 ? 's' : ''})`;

                    byProvider[provider].forEach((product, idx) => {
                        const productDiv = providerSection.appendChild(document.createElement('div'));
                        productDiv.style.cssText = 'padding: 8px; margin-bottom: 6px; background: #1a202c; border-radius: 4px; border: 1px solid #4a5568;';
                        
                        const productName = productDiv.appendChild(document.createElement('div'));
                        productName.style.cssText = 'font-weight: 700; color: #e2e8f0; margin-bottom: 4px; font-size: 0.8rem;';
                        productName.textContent = `${idx + 1}. ${product.product}`;

                        const productDetails = productDiv.appendChild(document.createElement('div'));
                        productDetails.style.cssText = 'font-size: 0.7rem; color: #a0aec0; line-height: 1.4;';
                        const sourceLink = product.sourceUrl || (product.source ? `https://www.google.com/search?q=${encodeURIComponent(product.source)}` : '');
                        productDetails.innerHTML = `
                            <div style="margin-bottom: 2px;"><strong>Date:</strong> ${new Date(product.date).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}</div>
                            <div style="margin-bottom: 2px;"><strong>Description:</strong> ${product.description}</div>
                            <div style="margin-bottom: 2px;"><strong>Category:</strong> <span style="color: #667eea;">${product.category}</span></div>
                            ${product.source ? `<div style="margin-top: 4px;"><strong>Source:</strong> <a href="${sourceLink}" target="_blank" rel="noopener noreferrer" style="color: #48bb78; font-style: italic; text-decoration: underline;">${product.source}</a></div>` : ''}
                        `;
                    });
                });
            });

            // Methodology note
            const methodologyNote = breakdownContent.appendChild(document.createElement('div'));
            methodologyNote.style.cssText = 'margin-top: 15px; padding-top: 12px; border-top: 1px solid #4a5568; font-size: 0.75rem; color: #a0aec0; line-height: 1.5;';
            methodologyNote.innerHTML = `
                <strong style="color: #667eea;">Counting Methodology:</strong> Each product is counted as a distinct memory-related release when it:
                <ul style="margin-top: 6px; padding-left: 18px; list-style: disc; font-size: 0.75rem;">
                    <li>Introduces new memory capabilities (APIs, storage, retrieval)</li>
                    <li>Expands memory capacity or functionality in existing products</li>
                    <li>Integrates memory into new application contexts (email, documents, collaboration)</li>
                    <li>Adds memory governance or portability features</li>
                </ul>
                <p style="margin-top: 8px; font-style: italic; font-size: 0.75rem;">Minor updates, bug fixes, and feature enhancements that don't add new memory capabilities are not counted. Each product represents a distinct announcement or release event.</p>
            `;

        }

        function renderAgentVelocity() {
            const container = document.getElementById('ecosystemAgentVelocityChart');
            const width = container.parentElement.clientWidth - 50;
            const height = 450;
            const margin = { top: 40, right: 30, bottom: 80, left: 70 };

            container.innerHTML = '';

            // Create tooltip
            const tooltip = d3.select(container).append('div')
                .attr('class', 'tooltip')
                .style('opacity', 0);

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            const data = dashboardData.ecosystem.agentFeatures;
            const quarters = ['Q1', 'Q2', 'Q3', 'Q4'];
            const providers = data.map(d => d.provider);
            
            // Calculate trends
            const trends = data.map(d => {
                const values = [d.q1, d.q2, d.q3, d.q4];
                const total = values.reduce((a, b) => a + b, 0);
                const avg = total / values.length;
                const trend = d.q4 > d.q1 ? 'increasing' : d.q4 < d.q1 ? 'decreasing' : 'stable';
                const growth = ((d.q4 - d.q1) / Math.max(d.q1, 1)) * 100;
                return { provider: d.provider, trend, growth, total, avg };
            });

            const xScale = d3.scaleBand()
                .domain(quarters)
                .range([0, chartWidth])
                .padding(0.2);

            const maxValue = d3.max(data, d => Math.max(d.q1, d.q2, d.q3, d.q4));
            const yScale = d3.scaleLinear()
                .domain([0, maxValue * 1.1])
                .range([chartHeight, 0]);

            const colorScale = d3.scaleOrdinal()
                .domain(providers)
                .range(['#4285f4', '#00a4ef', '#ff6b35', '#d4a574']);

            // Grouped bars
            const barWidth = xScale.bandwidth() / providers.length;

            quarters.forEach((quarter, qIdx) => {
                providers.forEach((provider, pIdx) => {
                    const value = data[pIdx][`q${qIdx + 1}`];
                    const x = xScale(quarter) + pIdx * barWidth;
                    const barHeight = chartHeight - yScale(value);
                    
                    const bar = g.append('rect')
                        .attr('x', x)
                        .attr('y', yScale(value))
                        .attr('width', barWidth - 2)
                        .attr('height', barHeight)
                        .attr('fill', colorScale(provider))
                        .attr('rx', 4)
                        .attr('cursor', 'pointer')
                        .style('opacity', 0.8);

                    // Value label
                    if (value > 0) {
                        g.append('text')
                            .attr('x', x + barWidth / 2)
                            .attr('y', yScale(value) - 5)
                            .attr('text-anchor', 'middle')
                            .attr('fill', '#e2e8f0')
                            .attr('font-size', '11px')
                            .attr('font-weight', '600')
                            .text(value);
                    }

                    // Tooltip
                    bar.on('mouseover', function(event) {
                        const trend = trends[pIdx];
                        tooltip.transition().duration(200).style('opacity', 1);
                        tooltip.html(`
                            <div class="tooltip-title">${provider} - ${quarter} 2024</div>
                            <div class="tooltip-item"><strong>Agent Features:</strong> ${value}</div>
                            <div class="tooltip-item"><strong>Quarterly Total:</strong> ${trend.total} features</div>
                            <div class="tooltip-item"><strong>Average per Quarter:</strong> ${trend.avg.toFixed(1)}</div>
                            <div class="tooltip-item"><strong>Trend:</strong> <span style="color: ${trend.trend === 'increasing' ? '#48bb78' : trend.trend === 'decreasing' ? '#e53e3e' : '#a0aec0'}">${trend.trend}</span></div>
                            <div class="tooltip-item"><strong>Growth (Q1→Q4):</strong> ${trend.growth > 0 ? '+' : ''}${trend.growth.toFixed(0)}%</div>
                            <div class="tooltip-item" style="margin-top: 8px; font-size: 0.8rem; color: #667eea;">
                                ${trend.trend === 'increasing' ? '↗ Strategic prioritization increasing' : 
                                  trend.trend === 'decreasing' ? '↘ Feature development slowing' : 
                                  '→ Steady development pace'}
                            </div>
                        `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                        
                        bar.style('opacity', 1);
                    })
                    .on('mouseout', function() {
                        tooltip.transition().duration(200).style('opacity', 0);
                        bar.style('opacity', 0.8);
                    });
                });
            });

            // Add trend lines for each provider
            providers.forEach((provider, pIdx) => {
                const trendData = quarters.map((q, qIdx) => ({
                    quarter: q,
                    value: data[pIdx][`q${qIdx + 1}`],
                    x: xScale(q) + xScale.bandwidth() / 2
                }));

                const line = d3.line()
                    .x(d => d.x)
                    .y(d => yScale(d.value))
                    .curve(d3.curveMonotoneX);

                g.append('path')
                    .datum(trendData)
                    .attr('fill', 'none')
                    .attr('stroke', colorScale(provider))
                    .attr('stroke-width', 2)
                    .attr('stroke-dasharray', '3,3')
                    .attr('opacity', 0.4)
                    .attr('d', line);
            });

            // Axes
            g.append('g')
                .attr('transform', `translate(0,${chartHeight})`)
                .call(d3.axisBottom(xScale))
                .selectAll('text')
                .attr('fill', '#a0aec0')
                .style('font-size', '12px');

            g.append('g')
                .call(d3.axisLeft(yScale).ticks(8))
                .selectAll('text')
                .attr('fill', '#a0aec0')
                .style('font-size', '11px');

            // Axis labels
            g.append('text')
                .attr('x', chartWidth / 2)
                .attr('y', chartHeight + 50)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .text('Quarter (2024)');

            g.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', -50)
                .attr('x', -chartHeight / 2)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .text('Number of Agent Features');

            // Legend
            const legend = container.appendChild(document.createElement('div'));
            legend.className = 'chart-legend';
            providers.forEach(provider => {
                const trend = trends.find(t => t.provider === provider);
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="legend-color" style="background: ${colorScale(provider)}"></div>
                    <div class="legend-text">${provider} (${trend.trend === 'increasing' ? '↗' : trend.trend === 'decreasing' ? '↘' : '→'} ${trend.total} total)</div>
                `;
                legend.appendChild(item);
            });

            // Info panel
            const infoPanel = container.appendChild(document.createElement('div'));
            infoPanel.className = 'chart-info';
            const topProvider = trends.reduce((a, b) => b.total > a.total ? b : a);
            infoPanel.innerHTML = `
                <strong>Chart Details:</strong> Agent feature velocity by provider and quarter. Trend lines (dashed) show development trajectory.
                Hover over bars for detailed metrics. <strong>${topProvider.provider}</strong> leads with ${topProvider.total} total agent features in 2024.
                This chart helps detect strategic prioritization shifts and competitive positioning.
            `;

            // Feature Breakdown Section (Collapsible)
            const breakdownSection = container.appendChild(document.createElement('div'));
            breakdownSection.style.cssText = 'margin-top: 20px; background: #1a202c; border: 2px solid #4a5568; border-radius: 12px; padding: 15px;';
            
            const breakdownHeader = breakdownSection.appendChild(document.createElement('div'));
            breakdownHeader.style.cssText = 'cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: space-between; padding: 10px 12px; background: #2d3748; border-radius: 6px; margin-bottom: 0; transition: all 0.3s ease; border: 1px solid #4a5568;';
            breakdownHeader.onmouseenter = function() {
                breakdownHeader.style.background = '#3d4758';
                breakdownHeader.style.borderColor = '#667eea';
            };
            breakdownHeader.onmouseleave = function() {
                breakdownHeader.style.background = '#2d3748';
                breakdownHeader.style.borderColor = '#4a5568';
            };
            breakdownHeader.onclick = function() {
                const isCollapsed = breakdownContent.style.display === 'none';
                breakdownContent.style.display = isCollapsed ? 'block' : 'none';
                expandIcon.textContent = isCollapsed ? '▼' : '▶';
                expandText.textContent = isCollapsed ? 'Click to collapse' : 'Click to expand';
                breakdownHeader.style.marginBottom = isCollapsed ? '15px' : '0';
            };
            
            const breakdownTitle = breakdownHeader.appendChild(document.createElement('div'));
            breakdownTitle.style.cssText = 'font-size: 0.95rem; font-weight: 700; color: #667eea; display: flex; align-items: center; gap: 8px;';
            breakdownTitle.textContent = '📋 Feature Breakdown by Provider & Quarter';
            
            const expandControl = breakdownHeader.appendChild(document.createElement('div'));
            expandControl.style.cssText = 'display: flex; align-items: center; gap: 8px; font-size: 0.75rem; color: #a0aec0;';
            
            const expandIcon = expandControl.appendChild(document.createElement('span'));
            expandIcon.style.cssText = 'font-size: 0.9rem; color: #667eea; font-weight: 700;';
            expandIcon.textContent = '▶';
            
            const expandText = expandControl.appendChild(document.createElement('span'));
            expandText.textContent = 'Click to expand';
            
            const breakdownContent = breakdownSection.appendChild(document.createElement('div'));
            breakdownContent.style.cssText = 'display: none;'; // Collapsed by default

            // Feature data from CSV
            const featureData = [
                { provider: 'Google', quarter: 'Q2', feature: 'Workspace Flows for Gemini in Workspace', angle: 'Orchestrated workflows + integrations', description: 'New Workspace Flows lets users describe a business process in natural language; Gemini designs and builds logic-driven workflows that automate tasks across Workspace apps and (eventually) third-party tools.', source: 'Google Workspace blog – "New AI capabilities in Workspace…" (Apr 9, 2025)', url: 'https://workspace.google.com/blog/product-announcements/new-ai-drives-business-results' },
                { provider: 'Google', quarter: 'Q4', feature: 'Gemini Agent (in Gemini 3)', angle: 'End-to-end task agents', description: '"Gemini Agent" can orchestrate complex, multi-step tasks (e.g., email clean-up, trip planning) across Gmail, Calendar, web, etc., with user confirmations for sensitive actions.', source: 'Reuters + product deep-dives (Nov 2025)', url: 'https://medium.com/%40roman_fedyskyi/google-releases-gemini-3-with-ai-agent-for-multi-step-tasks-ca87a62965cc' },
                { provider: 'Google', quarter: 'Q4', feature: 'Antigravity IDE (agent-first dev environment)', angle: 'Agentic developer workflows', description: 'Antigravity is an "agent-first" IDE where autonomous coding agents, powered by Gemini 3 Pro, manage editor, terminal, and browser tasks and can be orchestrated from a manager view', source: 'Wikipedia + coverage on Antigravity (Nov 18, 2025)', url: 'https://en.wikipedia.org/wiki/Google_Antigravity' },
                { provider: 'Google', quarter: 'Q4', feature: 'Gemini API – JSON Schema for multi-agent workflows', angle: 'LLM↔agent interface + reliability', description: 'Gemini API adds JSON Schema support so responses conform to structured schemas; explicitly framed as making multi-agent systems easier and more reliable (one agent\'s output becomes another\'s input)', source: 'Android Central summary of Google\'s update (Nov 7, 2025)', url: 'https://www.androidcentral.com/apps-software/ai/google-is-making-it-easier-to-use-the-gemini-api-in-multi-agent-workflows' },
                { provider: 'Microsoft', quarter: 'Q1', feature: 'Autonomous agents GA in Copilot Studio', angle: 'Autonomous workflows', description: 'March 2025 "What\'s new in Copilot Studio" announces Autonomous agents GA, enabling agents to automatically respond to events and execute tasks without constant human prompts.', source: 'Microsoft Copilot Studio blog (Mar 31, 2025)', url: 'https://www.microsoft.com/en-us/microsoft-copilot/blog/copilot-studio/whats-new-in-copilot-studio-march-2025/' },
                { provider: 'Microsoft', quarter: 'Q1', feature: 'Agent flows in Copilot Studio', angle: 'Visual orchestration', description: 'Same update adds agent flows, a visual designer for connecting triggers, logic, and actions into reusable workflows', source: 'Copilot Studio blog (Mar 2025)', url: 'https://www.microsoft.com/en-us/microsoft-copilot/blog/copilot-studio/whats-new-in-copilot-studio-march-2025/' },
                { provider: 'Microsoft', quarter: 'Q1', feature: 'Generative orchestration GA', angle: 'Scalable multi-tool coordination', description: 'Generative orchestration lets Copilot choose tools and actions dynamically during conversations, now GA in March 2025, improving scalability and flexibility of agent behavior.', source: 'Copilot Studio blog (Mar 2025)', url: 'https://www.microsoft.com/en-us/microsoft-copilot/blog/copilot-studio/whats-new-in-copilot-studio-march-2025/' },
                { provider: 'Microsoft', quarter: 'Q2', feature: 'Deeper Azure AI Foundry integration & autonomous agents support', angle: 'System integration + governance', description: 'Early-2025 updates highlight direct integration between Copilot Studio and Azure AI Foundry plus formal support for autonomous agents, making it easier to deploy agents across enterprise data and RAG apps.', source: 'Partner explainer referencing official "What\'s new" posts', url: 'https://www.serverless-solutions.com/microsoft-copilot-studio-expands-with-new-features/' },
                { provider: 'Microsoft', quarter: 'Q3', feature: '"Build/manage agents at scale" (Sept 2025 updates)', angle: 'Monitoring + scale', description: 'The September 2025 "What\'s new in Copilot Studio" roundup focuses on building richer agents, extending with advanced tools, and managing & measuring agents at scale', source: 'Copilot Studio monthly roundup (Sept 2025)', url: 'https://www.microsoft.com/en-us/microsoft-copilot/blog/copilot-studio/whats-new-in-copilot-studio-september-2025/' },
                { provider: 'Microsoft', quarter: 'Q4', feature: 'Copilot Studio October 2025 – governance & performance features', angle: 'Operational safety & analytics', description: 'October 2025 roundup (published November) emphasizes new capabilities under "manage and govern at scale" and "measure and improve performance," tightening operational controls and observability for agents.', source: 'Copilot Studio blog (Oct 2025)', url: 'https://www.microsoft.com/en-us/microsoft-copilot/blog/copilot-studio/whats-new-in-copilot-studio-october-2025/' },
                { provider: 'Microsoft', quarter: 'Q4', feature: 'Work IQ for custom agents (Ignite 2025)', angle: 'Enterprise-grade safety & grounding', description: 'At Microsoft Ignite 2025, Microsoft announces Work IQ for custom agents – an intelligence layer that grounds agents in existing permissions, sensitivity labels, compliance controls, audit logs, and policies', source: 'Microsoft Ignite 2025 blog (Nov 18, 2025)', url: 'https://www.microsoft.com/en-us/microsoft-365/blog/2025/11/18/microsoft-ignite-2025-copilot-and-agents-built-to-power-the-frontier-firm/' },
                { provider: 'OpenAI', quarter: 'Q1', feature: 'Operator (browser agent) in ChatGPT', angle: 'Autonomous computer-use workflows', description: '2025 updates to ChatGPT describe Operator as an AI agent that can perform tasks via browser interactions – filling forms, placing orders, scheduling appointments – inside a sandboxed VM.', source: 'ChatGPT feature summary (2025 section)', url: 'https://openai.com/index/introducing-operator/' },
                { provider: 'OpenAI', quarter: 'Q1', feature: 'Responses API (launch)', angle: 'Core agent API + multi-tool workflows', description: 'OpenAI launches the Responses API in March 2025 as the new foundation for agents, enabling multi-tool, multi-turn workflows and slated to replace the Assistants API by 2026.', source: 'OpenAI blog + Reuters + Verge coverage (Mar 11, 2025)', url: 'https://openai.com/index/new-tools-for-building-agents/' },
                { provider: 'OpenAI', quarter: 'Q2', feature: 'ChatGPT Codex agent (coding agent)', angle: 'Domain-specific agent + tool use', description: 'By May 2025, OpenAI introduces a Codex coding agent able to answer codebase questions, run tests, and propose PRs, based on a fine-tuned o3 model; one version acts via a cloud VM, another controls a local machine.', source: 'ChatGPT feature summary (2025)', url: 'https://openai.com/index/introducing-codex/' },
                { provider: 'OpenAI', quarter: 'Q3', feature: 'ChatGPT "multi-step task" agent', angle: 'Generalist workflow agent', description: 'July 2025 sees a "ChatGPT agent" capable of multi-step tasks (planning and executing jobs instead of just answering questions), again documented in the ChatGPT feature timeline.', source: 'ChatGPT feature summary (2025)', url: 'https://www.theverge.com/ai-artificial-intelligence/709158/openai-new-release-chatgpt-agent-operator-deep-research' },
                { provider: 'OpenAI', quarter: 'Q4', feature: 'AgentKit on top of Responses API', angle: 'Developer tooling for scalable agents', description: 'In October 2025, OpenAI launches AgentKit, building on Responses + Agents SDK so developers can design and run complex agent workflows more reliably (Agent Builder, workflows, etc.).', source: 'OpenAI blog + DevDay 2025 roundups (Oct 2025)', url: 'https://openai.com/index/introducing-agentkit/' },
                { provider: 'Anthropic', quarter: 'Q3', feature: 'Claude Desktop with persistent, permissioned AI', angle: 'Desktop integration + governance', description: '2025 analysis of Claude Desktop highlights "persistent, permissioned" assistants with desktop extensions and enterprise-ready governance levers, enabling agents to live alongside local files/tools in a controlled way.', source: 'Claude Desktop workflows explainer (Oct 22, 2025)', url: 'https://skywork.ai/blog/ai-agent/claude-desktop-ai-workflows-2025' },
                { provider: 'Anthropic', quarter: 'Q3', feature: 'Claude Computer Use 2025 — updated enterprise automation', angle: 'Computer-use automation', description: '2025 write-ups and docs show Claude\'s Computer Use tool evolving into a more reliable desktop automation capability, with metrics on success rates for enterprise workflows and documentation on screenshot/mouse/keyboard APIs.', source: 'Anthropic docs + independent analysis (Sep 2025)', url: 'https://www.kheyamind.ai/blogs/claude-computer-use-2025-ai-agents-desktop-control-success-rate-analysis' },
                { provider: 'Anthropic', quarter: 'Q4', feature: 'Claude Opus 4.5', angle: 'Stronger reasoning + memory for agents', description: 'Anthropic\'s Opus 4.5 release emphasizes powering "heavy-duty agentic workflows" (Excel automation, code migration, complex enterprise tasks), deeper memory, and improved defenses against prompt-injection', source: 'Anthropic announcement + press coverage (Nov 2025)', url: 'https://www.itpro.com/technology/artificial-intelligence/anthropic-announces-claude-opus-4-5-the-new-ai-coding-frontrunner' }
            ];

            const breakdownQuarters = ['Q1', 'Q2', 'Q3', 'Q4'];
            breakdownQuarters.forEach(quarter => {
                const quarterSection = breakdownContent.appendChild(document.createElement('div'));
                quarterSection.style.cssText = 'margin-bottom: 18px;';
                
                const quarterHeader = quarterSection.appendChild(document.createElement('div'));
                quarterHeader.style.cssText = 'font-size: 0.9rem; font-weight: 700; color: #e2e8f0; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;';
                const quarterFeatures = featureData.filter(f => f.quarter === quarter);
                quarterHeader.innerHTML = `
                    <span>${quarter} 2025</span>
                    <span style="font-size: 0.75rem; color: #667eea; font-weight: 600;">(${quarterFeatures.length} feature${quarterFeatures.length !== 1 ? 's' : ''})</span>
                `;

                // Group by provider
                const byProvider = {};
                quarterFeatures.forEach(feature => {
                    if (!byProvider[feature.provider]) {
                        byProvider[feature.provider] = [];
                    }
                    byProvider[feature.provider].push(feature);
                });

                Object.keys(byProvider).forEach(provider => {
                    const providerSection = quarterSection.appendChild(document.createElement('div'));
                    providerSection.style.cssText = 'margin-bottom: 12px; padding: 10px; background: #2d3748; border-radius: 6px; border-left: 3px solid ' + colorScale(provider) + ';';
                    
                    const providerHeader = providerSection.appendChild(document.createElement('div'));
                    providerHeader.style.cssText = 'font-weight: 700; color: #e2e8f0; margin-bottom: 8px; font-size: 0.85rem;';
                    providerHeader.textContent = `${provider} (${byProvider[provider].length} feature${byProvider[provider].length > 1 ? 's' : ''})`;

                    byProvider[provider].forEach((feature, idx) => {
                        const featureDiv = providerSection.appendChild(document.createElement('div'));
                        featureDiv.style.cssText = 'padding: 8px; margin-bottom: 6px; background: #1a202c; border-radius: 4px; border: 1px solid #4a5568;';
                        
                        const featureName = featureDiv.appendChild(document.createElement('div'));
                        featureName.style.cssText = 'font-weight: 700; color: #e2e8f0; margin-bottom: 4px; font-size: 0.8rem;';
                        featureName.textContent = `${idx + 1}. ${feature.feature}`;

                        const featureDetails = featureDiv.appendChild(document.createElement('div'));
                        featureDetails.style.cssText = 'font-size: 0.7rem; color: #a0aec0; line-height: 1.4;';
                        featureDetails.innerHTML = `
                            <div style="margin-bottom: 2px;"><strong>P2 Angle:</strong> <span style="color: #667eea;">${feature.angle}</span></div>
                            <div style="margin-bottom: 2px;"><strong>Description:</strong> ${feature.description}</div>
                            <div style="margin-top: 4px;"><strong>Source:</strong> <a href="${feature.url}" target="_blank" rel="noopener noreferrer" style="color: #48bb78; font-style: italic; text-decoration: underline;">${feature.source}</a></div>
                        `;
                    });
                });
            });
        }

        function renderIdentityRadar() {
            const container = document.getElementById('ecosystemIdentityRadarChart');
            const width = container.parentElement.clientWidth - 50;
            const height = 500;
            const margin = { top: 40, right: 40, bottom: 40, left: 40 };

            container.innerHTML = '';

            // Create tooltip
            const tooltip = d3.select(container).append('div')
                .attr('class', 'tooltip')
                .style('opacity', 0);

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 2 - 60;

            const dimensions = ['Workspace', 'Graph', 'Account', 'Cross-App', 'Privacy Controls'];
            const data = dashboardData.ecosystem.identityExpansions;
            const providers = Object.keys(data);

            const colorScale = d3.scaleOrdinal()
                .domain(providers)
                .range(['#4285f4', '#00a4ef', '#ff6b35', '#d4a574']);

            // Map dimensions to data keys
            const dimensionMap = {
                'Workspace': 'workspace',
                'Graph': 'graph',
                'Account': 'account',
                'Cross-App': 'workspace', // Using workspace as proxy
                'Privacy Controls': 'account' // Using account as proxy
            };

            const angleScale = d3.scalePoint()
                .domain(dimensions)
                .range([0, 2 * Math.PI]);

            const rScale = d3.scaleLinear()
                .domain([0, 15])
                .range([0, radius]);

            // Draw grid circles
            for (let i = 1; i <= 3; i++) {
                svg.append('circle')
                    .attr('cx', centerX)
                    .attr('cy', centerY)
                    .attr('r', (radius / 3) * i)
                    .attr('fill', 'none')
                    .attr('stroke', '#4a5568')
                    .attr('stroke-width', 1)
                    .attr('opacity', 0.3);

                svg.append('text')
                    .attr('x', centerX)
                    .attr('y', centerY - (radius / 3) * i + 5)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#a0aec0')
                    .attr('font-size', '10px')
                    .text((i * 5).toString());
            }

            // Draw dimension axes
            dimensions.forEach((dimension, i) => {
                const angle = angleScale(dimension);
                const x1 = centerX + Math.cos(angle) * radius;
                const y1 = centerY + Math.sin(angle) * radius;

                svg.append('line')
                    .attr('x1', centerX)
                    .attr('y1', centerY)
                    .attr('x2', x1)
                    .attr('y2', y1)
                    .attr('stroke', '#4a5568')
                    .attr('stroke-width', 1)
                    .attr('opacity', 0.3);

                // Dimension labels
                const labelX = centerX + Math.cos(angle) * (radius + 30);
                const labelY = centerY + Math.sin(angle) * (radius + 30);
                svg.append('text')
                    .attr('x', labelX)
                    .attr('y', labelY)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#e2e8f0')
                    .attr('font-size', '12px')
                    .attr('font-weight', '600')
                    .text(dimension);
            });

            // Draw radar for each provider
            providers.forEach((provider, pIdx) => {
                const providerData = data[provider];
                const points = dimensions.map(dim => {
                    const key = dimensionMap[dim];
                    const value = providerData[key] || 0;
                    const angle = angleScale(dim);
                    const r = rScale(value);
                    return {
                        angle,
                        r,
                        x: centerX + Math.cos(angle) * r,
                        y: centerY + Math.sin(angle) * r,
                        dimension: dim,
                        value
                    };
                });

                // Draw area
                const line = d3.lineRadial()
                    .angle(d => d.angle)
                    .radius(d => d.r)
                    .curve(d3.curveLinearClosed);

                const area = svg.append('path')
                    .datum(points)
                    .attr('d', line)
                    .attr('fill', colorScale(provider))
                    .attr('fill-opacity', 0.2)
                    .attr('stroke', colorScale(provider))
                    .attr('stroke-width', 2)
                    .attr('cursor', 'pointer')
                    .on('mouseover', function(event) {
                        tooltip.transition().duration(200).style('opacity', 1);
                        const total = points.reduce((sum, p) => sum + p.value, 0);
                        const avg = total / points.length;
                        tooltip.html(`
                            <div class="tooltip-title">${provider} Identity Surface</div>
                            ${points.map(p => `
                                <div class="tooltip-item"><strong>${p.dimension}:</strong> ${p.value} capabilities</div>
                            `).join('')}
                            <div class="tooltip-item" style="margin-top: 8px; border-top: 1px solid #4a5568; padding-top: 8px;">
                                <strong>Total:</strong> ${total} capabilities | <strong>Average:</strong> ${avg.toFixed(1)} per dimension
                            </div>
                            <div class="tooltip-item" style="margin-top: 8px; font-size: 0.8rem; color: #e53e3e;">
                                ⚠ Higher values indicate greater lock-in risk
                            </div>
                        `)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY - 10) + 'px');
                        area.attr('fill-opacity', 0.4);
                    })
                    .on('mouseout', function() {
                        tooltip.transition().duration(200).style('opacity', 0);
                        area.attr('fill-opacity', 0.2);
                    });

                // Draw points
                points.forEach(point => {
                    svg.append('circle')
                        .attr('cx', point.x)
                        .attr('cy', point.y)
                        .attr('r', 4)
                        .attr('fill', colorScale(provider))
                        .attr('stroke', '#e2e8f0')
                        .attr('stroke-width', 2);
                });
            });

            // Legend
            const legend = container.appendChild(document.createElement('div'));
            legend.className = 'chart-legend';
            providers.forEach(provider => {
                const providerData = data[provider];
                const total = Object.values(providerData).reduce((a, b) => a + b, 0);
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="legend-color" style="background: ${colorScale(provider)}"></div>
                    <div class="legend-text">${provider} (${total} total)</div>
                `;
                legend.appendChild(item);
            });

            // Info panel
            const infoPanel = container.appendChild(document.createElement('div'));
            infoPanel.className = 'chart-info';
            const maxProvider = providers.reduce((a, b) => {
                const totalA = Object.values(data[a]).reduce((s, v) => s + v, 0);
                const totalB = Object.values(data[b]).reduce((s, v) => s + v, 0);
                return totalB > totalA ? b : a;
            });
            infoPanel.innerHTML = `
                <strong>Chart Details:</strong> Radar chart showing identity-linked capability expansion across five dimensions. 
                Larger surfaces indicate more identity binding, which signals higher lock-in risk. 
                <strong>${maxProvider}</strong> shows the largest identity surface expansion. Hover over areas for detailed breakdowns.
            `;

            // Rationale section
            createCollapsibleRationale(container, `
                <div class="chart-rationale-content">
                    <p>The Identity Surface Expansion radar chart is the primary lock-in risk indicator. Identity systems (Workspace, Graph, Account) are the most powerful lock-in mechanisms because they create switching costs that grow with usage. This chart reveals:</p>
                    <ul class="chart-rationale-list">
                        <li><strong>Lock-in trajectory:</strong> Larger surfaces indicate providers are binding more capabilities to identity, making switching progressively harder</li>
                        <li><strong>Platform dependencies:</strong> Identity expansion correlates with deeper platform dependencies and reduced user autonomy</li>
                        <li><strong>Market concentration risk:</strong> As identity surfaces expand, markets consolidate around fewer dominant platforms</li>
                        <li><strong>Intervention urgency:</strong> Providers with rapidly expanding surfaces require immediate attention for PLP positioning</li>
                    </ul>
                </div>
                <div class="chart-rationale-section">
                    <strong>How to Interpret:</strong>
                    <p>Each dimension represents a different type of identity binding: Workspace (productivity tools), Graph (data connections), Account (authentication), Cross-App (integration), and Privacy Controls (data governance). Providers with large, balanced surfaces across all dimensions have the highest lock-in risk. Asymmetric expansion (e.g., strong in Graph but weak in Privacy) may indicate strategic priorities or compliance gaps.</p>
                </div>
                <div class="chart-rationale-section">
                    <strong>Strategic Actions:</strong>
                    <ul class="chart-rationale-list">
                        <li>Prioritize competitive responses to providers with rapidly expanding identity surfaces</li>
                        <li>Use asymmetry patterns to identify PLP differentiation opportunities (e.g., stronger privacy controls)</li>
                        <li>Track identity expansion velocity — acceleration indicates urgent market intervention needed</li>
                    </ul>
                </div>
            `);
        }

        // Module 2: Memory Architecture
        function renderMemoryModule() {
            renderOpennessMatrix();
            renderRecallDepthChart();
        }

        function renderOpennessMatrix() {
            const container = document.getElementById('memoryOpennessMatrix');
            const width = container.parentElement.clientWidth - 50;
            const height = 450;
            const margin = { top: 20, right: 30, bottom: 60, left: 60 };

            container.innerHTML = '';

            // Tooltip for combined openness + identity lock-in insight
            const tooltip = d3.select(container).append('div')
                .attr('class', 'tooltip')
                .style('opacity', 0);

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            const providers = dashboardData.memory.providers;
            const identityLockInData = dashboardData.memory.identityLockIn;
            const identityLockInMap = identityLockInData.reduce((acc, item) => {
                acc[item.provider] = item;
                return acc;
            }, {});

            // Conceptual bands for openness and lock-in based on CSV reference
            const conceptualBands = {
                'Google': {
                    opennessBand: 'Low',
                    lockInBand: 'High',
                    category: 'Maximum Risk'
                },
                'Microsoft': {
                    opennessBand: 'Medium-High',
                    lockInBand: 'Medium',
                    category: 'Limited but Manageable'
                },
                'OpenAI': {
                    opennessBand: 'Medium',
                    lockInBand: 'Medium-High',
                    category: 'Limited but Manageable'
                },
                'Anthropic': {
                    opennessBand: 'High',
                    lockInBand: 'Low',
                    category: 'Opportunity Zone'
                }
            };

            const xScale = d3.scaleLinear()
                .domain([0, 100])
                .range([0, chartWidth]);

            const yScale = d3.scaleLinear()
                .domain([0, 100])
                .range([chartHeight, 0]);

            // Color scale for identity lock-in percentage
            const colorScale = d3.scaleSequential(d3.interpolateRdYlGn)
                .domain([100, 0]);

            // Size scale for cross-app reach (bubble size)
            const maxReach = d3.max(providers, p => p.crossAppReach || 0) || 1;
            const sizeScale = d3.scaleSqrt()
                .domain([0, maxReach])
                .range([8, 20]);

            // Draw quadrant lines
            g.append('line')
                .attr('x1', xScale(50))
                .attr('y1', 0)
                .attr('x2', xScale(50))
                .attr('y2', chartHeight)
                .attr('stroke', '#4a5568')
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '5,5');

            g.append('line')
                .attr('x1', 0)
                .attr('y1', yScale(50))
                .attr('x2', chartWidth)
                .attr('y2', yScale(50))
                .attr('stroke', '#4a5568')
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '5,5');

            // Subtle quadrant background shading with labels
            const quadrantConfigs = [
                {
                    label: 'Opportunity Zone',
                    description: 'High Openness • Low Lock-In',
                    xRange: [50, 100],
                    yRange: [0, 50],
                    fill: 'rgba(56, 161, 105, 0.10)'
                },
                {
                    label: 'Strategic Risk',
                    description: 'High Openness • High Lock-In',
                    xRange: [50, 100],
                    yRange: [50, 100],
                    fill: 'rgba(237, 137, 54, 0.10)'
                },
                {
                    label: 'Limited but Manageable',
                    description: 'Low Openness • Low Lock-In',
                    xRange: [0, 50],
                    yRange: [0, 50],
                    fill: 'rgba(99, 179, 237, 0.08)'
                },
                {
                    label: 'Maximum Risk',
                    description: 'Low Openness • High Lock-In',
                    xRange: [0, 50],
                    yRange: [50, 100],
                    fill: 'rgba(229, 62, 62, 0.08)'
                }
            ];

            quadrantConfigs.forEach(q => {
                const x1 = xScale(q.xRange[0]);
                const x2 = xScale(q.xRange[1]);
                const y1 = yScale(q.yRange[1]);
                const y2 = yScale(q.yRange[0]);

                g.append('rect')
                    .attr('x', x1)
                    .attr('y', y1)
                    .attr('width', x2 - x1)
                    .attr('height', y2 - y1)
                    .attr('fill', q.fill)
                    .attr('stroke', 'none');

                g.append('text')
                    .attr('x', x1 + (x2 - x1) / 2)
                    .attr('y', y1 + 20)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#cbd5e0')
                    .attr('font-size', '11px')
                    .attr('font-weight', '700')
                    .text(q.label);

                g.append('text')
                    .attr('x', x1 + (x2 - x1) / 2)
                    .attr('y', y1 + 36)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#a0aec0')
                    .attr('font-size', '10px')
                    .text(q.description);
            });

            // Plot providers (merged with Identity Lock-In Index)
            providers.forEach(provider => {
                const x = xScale(provider.opennessScore);
                const identityEntry = identityLockInMap[provider.name] || { percentage: provider.lockInIndex, description: '', details: '' };
                const lockInPercent = identityEntry.percentage;
                const y = yScale(lockInPercent);
                const reach = provider.crossAppReach || 0;
                const r = sizeScale(reach);

                const bands = conceptualBands[provider.name] || {};
                
                const circle = g.append('circle')
                    .attr('cx', x)
                    .attr('cy', y)
                    .attr('r', r)
                    .attr('fill', colorScale(lockInPercent))
                    .attr('stroke', '#e2e8f0')
                    .attr('stroke-width', 2)
                    .attr('cursor', 'pointer')
                    .on('click', () => showProviderDetails(provider))
                    .on('mouseover', function(event) {
                        tooltip.transition().duration(200).style('opacity', 1);
                        
                        // Special tooltip for Google with detailed I³ Pillars information
                        if (provider.name === 'Google') {
                            tooltip.html(`
                                <div class="tooltip-title">${provider.name}</div>
                                <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #4a5568;">
                                    <div style="font-weight: 600; color: #e2e8f0; margin-bottom: 4px;">Position:</div>
                                    <div style="color: #cbd5e0; font-size: 0.9rem;">Low–Middle Openness / High Lock-In</div>
                                </div>
                                <div style="margin-bottom: 8px; font-weight: 600; color: #e2e8f0;">Key Indicators Across I³ Pillars:</div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P1 – Data Access, Integration & Open Standards:</strong> 6 distinct memory features documented (lowest among the four), all tightly embedded in Google's own stack rather than exposed as portable primitives.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P2 – Scalable & Safe AI Workflows:</strong> Long-context capacity is extremely high as Google appears with 3 long-context models, averaging ~677K tokens and up to 1,000K tokens of context.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P3 – Human Capacity & Trust:</strong> Broad educator reach via Workspace for Education globally with limited education-tagged agent features.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P4 – Public-Good Alliances:</strong> Strong public signaling (Google.org, governance forums); most value is mediated through the core Workspace ecosystem.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P5 – Responsible AI & Governance:</strong> Model cards published inconsistently; safety cards exist but memory transparency is limited.
                                </div>
                            `)
                            .style('left', (event.pageX + 10) + 'px')
                            .style('top', (event.pageY - 10) + 'px')
                            .style('max-width', '500px')
                            .style('max-height', '600px')
                            .style('overflow-y', 'auto');
                        } else if (provider.name === 'Microsoft') {
                            tooltip.html(`
                                <div class="tooltip-title">${provider.name}</div>
                                <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #4a5568;">
                                    <div style="font-weight: 600; color: #e2e8f0; margin-bottom: 4px;">Position:</div>
                                    <div style="color: #cbd5e0; font-size: 0.9rem;">Medium-High Openness / Medium Lock-In</div>
                                </div>
                                <div style="margin-bottom: 8px; font-weight: 600; color: #e2e8f0;">Key Indicators Across I³ Pillars:</div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P1 – Data Access, Integration & Open Standards:</strong> 8 memory features, 8 memory types (high surface). It has a strong alignment via Graph + connectors.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P2 – Scalable & Safe AI Workflows:</strong> Microsoft leads all providers in documented agent/workflow features and pairs this with one of the strongest long-context stacks—six models averaging ~273K tokens and scaling to 1M—positioning it as the most capable platform for complex, multi-document AI workflows.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P3 – Human Capacity & Trust:</strong> It provides substantial surface for educator- and admin-facing integrations, especially in M365 districts.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P4 – Public-Good Alliances:</strong> Microsoft appears in more workflow and model entries than any other provider, reflecting its broad public-sector footprint and its co-development posture with ministries and NGOs - positioning it as the most embedded hyperscaler in government-aligned AI deployments.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P5 – Responsible AI & Governance:</strong> Microsoft leads with consistent transparency (model/system cards), formal independent oversight, and youth-focused safeguards such as supervised Copilot experiences and robust admin controls.
                                </div>
                            `)
                            .style('left', (event.pageX + 10) + 'px')
                            .style('top', (event.pageY - 10) + 'px')
                            .style('max-width', '500px')
                            .style('max-height', '600px')
                            .style('overflow-y', 'auto');
                        } else if (provider.name === 'OpenAI') {
                            tooltip.html(`
                                <div class="tooltip-title">${provider.name}</div>
                                <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #4a5568;">
                                    <div style="font-weight: 600; color: #e2e8f0; margin-bottom: 4px;">Position:</div>
                                    <div style="color: #cbd5e0; font-size: 0.9rem;">Medium Openness / High-ish Lock-In</div>
                                </div>
                                <div style="margin-bottom: 8px; font-weight: 600; color: #e2e8f0;">Key Indicators Across I³ Pillars:</div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P1 – Data Access & Open Standard:</strong> Strong memory depth (9 features, 8 types) but tightly bound to OpenAI-controlled runtimes, meaning high capability but weaker portability and open-standard alignment.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P2 – Scalable & Safe AI Workflows:</strong> Robust agentic surface (5 workflow features), yet limited long-context capacity (4 models, ~76K avg, 128K max) pushes more workloads into proprietary scaffolds like GPTs and Assistants.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P3 – Human Capacity & Trust:</strong> Lack of explicit educator PD or training infrastructure signals a model-centric strategy - strong tools but less support for full ecosystem capacity-building.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P4 – Public-Good Alliances:</strong> Engagement comes mainly through integrator partners (e.g., Khanmigo), with fewer broad public-sector or governance alliances relative to Microsoft—limiting system-level influence.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P5 – Responsible AI & Governance:</strong> Publishes detailed model cards and some oversight signals, but audit coverage is limited; youth safeguards (e.g., ChatGPT for Schools) are improving but uneven across markets - resulting in a governance posture that is credible but less comprehensive than peers.
                                </div>
                            `)
                            .style('left', (event.pageX + 10) + 'px')
                            .style('top', (event.pageY - 10) + 'px')
                            .style('max-width', '500px')
                            .style('max-height', '600px')
                            .style('overflow-y', 'auto');
                        } else if (provider.name === 'Anthropic') {
                            tooltip.html(`
                                <div class="tooltip-title">${provider.name}</div>
                                <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #4a5568;">
                                    <div style="font-weight: 600; color: #e2e8f0; margin-bottom: 4px;">Position:</div>
                                    <div style="color: #cbd5e0; font-size: 0.9rem;">High Openness / Low Lock-In</div>
                                </div>
                                <div style="margin-bottom: 8px; font-weight: 600; color: #e2e8f0;">Key Indicators Across I³ Pillars:</div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P1 – Data Access, Integration & Open Standards:</strong> Anthropic offers a diverse set of memory-related behaviors and features - positioning Anthropic as the most standards-aligned and least lock-in–dependent memory layer.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P2 – Scalable & Safe AI Workflows:</strong> Fewer workflow features (3) but strong long-context capacity (4 models, ~175K average, 200K max), enabling stable multi-document reasoning without relying on heavy proprietary scaffolds.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P3 – Human Capacity & Trust:</strong> Model entries emphasize reliability and long-context strength, aligning Anthropic with high-trust, regulated, and education-relevant workloads - even as large-scale PD ecosystems are still in early stages.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P4 – Public-Good Alliances:</strong> Presence is lean but governance-heavy, reflecting a strategy centered on Constitutional AI and Responsible Scaling rather than bundling large product suites or broad institutional integrations.
                                </div>
                                <div style="margin-bottom: 10px; padding: 8px; background: rgba(74, 85, 104, 0.3); border-radius: 4px; font-size: 0.85rem; line-height: 1.4;">
                                    <strong>P5 – Responsible AI & Governance:</strong> Leads the field on safety frameworks (Constitutional AI, RSP) with high transparency through safety cards and policy disclosures, alongside youth-appropriate safeguards and conservative design choices to reduce harmful outputs - making it the strongest governance-first provider.
                                </div>
                            `)
                            .style('left', (event.pageX + 10) + 'px')
                            .style('top', (event.pageY - 10) + 'px')
                            .style('max-width', '500px')
                            .style('max-height', '600px')
                            .style('overflow-y', 'auto');
                        } else {
                            // Default tooltip for other providers
                            tooltip.html(`
                                <div class="tooltip-title">${provider.name} — Openness vs Identity Lock-In</div>
                                <div class="tooltip-item"><strong>Memory Openness Score:</strong> ${provider.opennessScore}</div>
                                <div class="tooltip-item"><strong>Identity Lock-In Index:</strong> ${lockInPercent}%</div>
                                <div class="tooltip-item"><strong>Openness Band:</strong> ${bands.opennessBand || (provider.opennessScore >= 55 ? 'High' : provider.opennessScore >= 40 ? 'Medium' : 'Low')}</div>
                                <div class="tooltip-item"><strong>Lock-In Band:</strong> ${bands.lockInBand || (lockInPercent >= 70 ? 'High' : lockInPercent >= 40 ? 'Medium' : 'Low')}</div>
                                <div class="tooltip-item"><strong>Category:</strong> ${bands.category || (lockInPercent >= 70 && provider.opennessScore < 50 ? 'Maximum Risk' : 'Mixed')}</div>
                                <div class="tooltip-item"><strong>Recall Depth:</strong> ${provider.recallDepth.toLocaleString()} tokens</div>
                                <div class="tooltip-item"><strong>Cross-App Reach:</strong> ${provider.crossAppReach} apps</div>
                                <div class="tooltip-item"><strong>Default-On Rate:</strong> ${provider.defaultOnRate}%</div>
                                ${identityEntry.description ? `<div class="tooltip-item" style="margin-top: 8px;"><strong>Identity Binding:</strong> ${identityEntry.description}</div>` : ''}
                                ${identityEntry.details ? `<div class="tooltip-item" style="font-size: 0.8rem; color: #cbd5e0; margin-top: 4px;">${identityEntry.details}</div>` : ''}
                            `)
                            .style('left', (event.pageX + 10) + 'px')
                            .style('top', (event.pageY - 10) + 'px');
                        }

                        d3.select(this).attr('stroke-width', 3);
                    })
                    .on('mouseout', function() {
                        tooltip.transition().duration(200).style('opacity', 0);
                        d3.select(this).attr('stroke-width', 2);
                    });

                // Label with provider name only
                // For Anthropic (in Opportunity Zone), position label below to avoid overlapping quadrant text
                const labelOffset = provider.name === 'Anthropic' ? 25 : -20;
                g.append('text')
                    .attr('x', x)
                    .attr('y', y + labelOffset)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#e2e8f0')
                    .attr('font-size', '13px')
                    .attr('font-weight', '700')
                    .text(provider.name);
            });

            // Conceptual axis labels - only Low and High, once each
            // X-axis labels
            g.append('text')
                .attr('x', xScale(0))
                .attr('y', chartHeight + 20)
                .attr('text-anchor', 'start')
                .attr('fill', '#a0aec0')
                .style('font-size', '12px')
                .style('font-weight', '600')
                .text('Low');
            
            g.append('text')
                .attr('x', xScale(100))
                .attr('y', chartHeight + 20)
                .attr('text-anchor', 'end')
                .attr('fill', '#a0aec0')
                .style('font-size', '12px')
                .style('font-weight', '600')
                .text('High');

            // Y-axis labels
            g.append('text')
                .attr('x', -10)
                .attr('y', yScale(100) + 5)
                .attr('text-anchor', 'end')
                .attr('fill', '#a0aec0')
                .style('font-size', '12px')
                .style('font-weight', '600')
                .text('High');
            
            g.append('text')
                .attr('x', -10)
                .attr('y', yScale(0) + 5)
                .attr('text-anchor', 'end')
                .attr('fill', '#a0aec0')
                .style('font-size', '12px')
                .style('font-weight', '600')
                .text('Low');

            // Axis labels
            g.append('text')
                .attr('x', chartWidth / 2)
                .attr('y', chartHeight + 50)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .style('font-weight', '600')
                .text('Memory Openness (Low → Middle → High)');

            g.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', -50)
                .attr('x', -chartHeight / 2)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .style('font-weight', '600')
                .text('Identity Lock-In (Low → Middle → High)');

            // Legend explaining color and size encoding
            const legendContainer = container.appendChild(document.createElement('div'));
            legendContainer.className = 'chart-legend';
            legendContainer.style.marginTop = '10px';

            const colorLegend = document.createElement('div');
            colorLegend.className = 'legend-item';
            colorLegend.innerHTML = `
                <div class="legend-color" style="background: linear-gradient(90deg, #48bb78, #f6e05e, #e53e3e); width: 40px;"></div>
                <div class="legend-text">Color = Identity Lock-In (Green = low, Red = high)</div>
            `;
            legendContainer.appendChild(colorLegend);

            const sizeLegend = document.createElement('div');
            sizeLegend.className = 'legend-item';
            sizeLegend.innerHTML = `
                <div class="legend-color" style="background: #4a5568; border-radius: 999px; width: 16px; height: 16px;"></div>
                <div class="legend-text">Bubble Size = Cross-App Memory Reach (# of apps)</div>
            `;
            legendContainer.appendChild(sizeLegend);

            // Rationale section
            createCollapsibleRationale(container, `
                <div class="chart-rationale-content">
                    <p><strong>Methodology:</strong> The development of each hyperscaler on the Memory Openness vs. Lock-In matrix is grounded in three complementary datasets. First, we reviewed hyperscaler product releases to identify memory-related workflow and agent features that signal how openly each provider enables developers and partners to work with memory. This measure captures the quantity of memory-centric features (quantitative) and the nature of those features - for example, whether they are designed as open schemas, extensible agent interfaces, or tightly coupled proprietary tools. Second, we examined documented memory capabilities - such as user controls, transparency mechanisms, override and deletion functions, integration pathways, and exportability options - to understand how much flexibility and portability each ecosystem offers. The quantitative signals include how many memory behaviors are exposed in each provider's documentation, while the qualitative assessment evaluates clarity of documentation, partner usability, and alignment with district data-governance needs. Third, we evaluated long-context performance data to see whether a model relies on open, stable model-level memory or depends heavily on proprietary scaffolding. Quantitatively, this included effective recall depth and stability under load; qualitatively, we assessed whether unstable long-context behavior forces developers into vendor-specific memory pipelines, increasing dependency.</p>
                </div>
            `, 'Methodology & Data Sources');
        }

        function showProviderDetails(provider) {
            alert(`${provider.name} Details:\n\n` +
                  `Lock-In Index: ${provider.lockInIndex}\n` +
                  `Openness Score: ${provider.opennessScore}\n` +
                  `Recall Depth: ${provider.recallDepth.toLocaleString()} tokens\n` +
                  `Cross-App Reach: ${provider.crossAppReach} apps\n` +
                  `Default-On Rate: ${provider.defaultOnRate}%\n` +
                  `Visibility Index: ${provider.visibilityIndex}\n\n` +
                  `Apps: ${provider.apps.join(', ')}`);
        }


        function renderRecallDepthChart() {
            const container = document.getElementById('memoryRecallDepthChart');
            const width = container.parentElement.clientWidth - 50;
            const height = 450;
            const margin = { top: 40, right: 100, bottom: 80, left: 80 };

            container.innerHTML = '';

            // Create tooltip
            const tooltip = d3.select(container).append('div')
                .attr('class', 'tooltip')
                .style('opacity', 0);

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            const data = dashboardData.memory.recallDepthHistory.sort((a, b) => new Date(a.date + '-01') - new Date(b.date + '-01'));

            // Group by provider
            const providers = ['GPT', 'Claude', 'Gemini'];
            const providerColors = { 'GPT': '#ff6b35', 'Claude': '#e67e22', 'Gemini': '#4285f4' };
            
            const dataByProvider = {};
            data.forEach(d => {
                const provider = d.model.split('-')[0].split('_')[0];
                if (!dataByProvider[provider]) dataByProvider[provider] = [];
                dataByProvider[provider].push({ ...d, provider });
            });

            const xScale = d3.scaleTime()
                .domain(d3.extent(data, d => new Date(d.date + '-01')))
                .range([0, chartWidth]);

            const yScale = d3.scaleLog()
                .domain([1000, 1000000])
                .range([chartHeight, 0]);

            // Draw lines for each provider
            Object.keys(dataByProvider).forEach(provider => {
                const providerData = dataByProvider[provider];
                const line = d3.line()
                    .x(d => xScale(new Date(d.date + '-01')))
                    .y(d => yScale(d.depth))
                    .curve(d3.curveMonotoneX);

                g.append('path')
                    .datum(providerData)
                    .attr('fill', 'none')
                    .attr('stroke', providerColors[provider] || '#667eea')
                    .attr('stroke-width', 3)
                    .attr('opacity', 0.8)
                    .attr('d', line);
            });

            // Points with tooltips and annotations
            data.forEach((d, i) => {
                const date = new Date(d.date + '-01');
                const x = xScale(date);
                const y = yScale(d.depth);
                const provider = d.model.split('-')[0].split('_')[0];

                // Calculate growth
                const prev = i > 0 ? data[i - 1] : null;
                const growth = prev ? ((d.depth - prev.depth) / prev.depth * 100) : 0;
                const isMajorJump = growth > 100;

                // Point
                const circle = g.append('circle')
                    .attr('cx', x)
                    .attr('cy', y)
                    .attr('r', isMajorJump ? 8 : 6)
                    .attr('fill', providerColors[provider] || '#667eea')
                    .attr('stroke', '#e2e8f0')
                    .attr('stroke-width', isMajorJump ? 3 : 2)
                    .attr('cursor', 'pointer')
                    .style('opacity', 0.9);

                // Model label
                const labelOffset = y < chartHeight / 2 ? -20 : 20;
                g.append('text')
                    .attr('x', x)
                    .attr('y', y + labelOffset)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#e2e8f0')
                    .attr('font-size', '10px')
                    .attr('font-weight', '600')
                    .text(d.model);

                // Annotation for major jumps
                if (isMajorJump) {
                    g.append('line')
                        .attr('x1', x)
                        .attr('y1', y - 15)
                        .attr('x2', x)
                        .attr('y2', y - 30)
                        .attr('stroke', '#e53e3e')
                        .attr('stroke-width', 2)
                        .attr('stroke-dasharray', '3,3');

                    g.append('text')
                        .attr('x', x)
                        .attr('y', y - 35)
                        .attr('text-anchor', 'middle')
                        .attr('fill', '#e53e3e')
                        .attr('font-size', '11px')
                        .attr('font-weight', '700')
                        .text(`+${growth.toFixed(0)}%`);
                }

                // Tooltip
                circle.on('mouseover', function(event) {
                    tooltip.transition().duration(200).style('opacity', 1);
                    tooltip.html(`
                        <div class="tooltip-title">${d.model}</div>
                        <div class="tooltip-item"><strong>Provider:</strong> ${provider}</div>
                        <div class="tooltip-item"><strong>Release Date:</strong> ${d3.timeFormat('%B %Y')(date)}</div>
                        <div class="tooltip-item"><strong>Recall Depth:</strong> ${d.depth.toLocaleString()} tokens</div>
                        <div class="tooltip-item"><strong>Human Equivalent:</strong> ~${Math.round(d.depth / 750)} pages</div>
                        ${prev ? `
                            <div class="tooltip-item" style="margin-top: 8px; border-top: 1px solid #4a5568; padding-top: 8px;">
                                <strong>Previous:</strong> ${prev.model} (${prev.depth.toLocaleString()} tokens)
                            </div>
                            <div class="tooltip-item"><strong>Growth:</strong> ${growth > 0 ? '+' : ''}${growth.toFixed(1)}%</div>
                            <div class="tooltip-item"><strong>Absolute Increase:</strong> +${(d.depth - prev.depth).toLocaleString()} tokens</div>
                            ${isMajorJump ? '<div class="tooltip-item" style="color: #e53e3e; font-weight: 600;">⚠ Major recall depth increase - high personalization risk</div>' : ''}
                        ` : '<div class="tooltip-item">First tracked release</div>'}
                        <div class="tooltip-item" style="margin-top: 8px; font-size: 0.8rem; color: #667eea;">
                            Deeper recall → Better context → Higher lock-in risk
                        </div>
                    `)
                    .style('left', (event.pageX + 10) + 'px')
                    .style('top', (event.pageY - 10) + 'px');
                    
                    circle.attr('r', isMajorJump ? 10 : 8).style('opacity', 1);
                })
                .on('mouseout', function() {
                    tooltip.transition().duration(200).style('opacity', 0);
                    circle.attr('r', isMajorJump ? 8 : 6).style('opacity', 0.9);
                });
            });

            // Highlight high-risk zone (above 100K tokens)
            const riskThreshold = 100000;
            g.append('rect')
                .attr('x', 0)
                .attr('y', yScale(riskThreshold))
                .attr('width', chartWidth)
                .attr('height', yScale(1000) - yScale(riskThreshold))
                .attr('fill', 'rgba(229, 62, 62, 0.1)')
                .attr('stroke', '#e53e3e')
                .attr('stroke-width', 1)
                .attr('stroke-dasharray', '5,5');

            g.append('text')
                .attr('x', chartWidth - 10)
                .attr('y', yScale(riskThreshold) + 15)
                .attr('text-anchor', 'end')
                .attr('fill', '#e53e3e')
                .attr('font-size', '11px')
                .attr('font-weight', '600')
                .text('High Risk Zone (>100K tokens)');

            // Axes
            g.append('g')
                .attr('transform', `translate(0,${chartHeight})`)
                .call(d3.axisBottom(xScale).ticks(8).tickFormat(d3.timeFormat('%b %Y')))
                .selectAll('text')
                .attr('fill', '#a0aec0')
                .style('font-size', '11px')
                .attr('transform', 'rotate(-45)')
                .style('text-anchor', 'end');

            g.append('g')
                .call(d3.axisLeft(yScale).tickFormat(d => d / 1000 + 'K'))
                .selectAll('text')
                .attr('fill', '#a0aec0')
                .style('font-size', '11px');

            // Axis labels
            g.append('text')
                .attr('x', chartWidth / 2)
                .attr('y', chartHeight + 60)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .text('Model Release Date');

            g.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', -60)
                .attr('x', -chartHeight / 2)
                .style('text-anchor', 'middle')
                .attr('fill', '#a0aec0')
                .style('font-size', '14px')
                .text('Effective Recall Depth (tokens, log scale)');

            // Legend
            const legend = container.appendChild(document.createElement('div'));
            legend.className = 'chart-legend';
            Object.keys(dataByProvider).forEach(provider => {
                const item = document.createElement('div');
                item.className = 'legend-item';
                const maxDepth = Math.max(...dataByProvider[provider].map(d => d.depth));
                item.innerHTML = `
                    <div class="legend-color" style="background: ${providerColors[provider] || '#667eea'}"></div>
                    <div class="legend-text">${provider} (max: ${(maxDepth / 1000).toFixed(0)}K tokens)</div>
                `;
                legend.appendChild(item);
            });

            // Info panel
            const infoPanel = container.appendChild(document.createElement('div'));
            infoPanel.className = 'chart-info';
            const maxModel = data.reduce((a, b) => b.depth > a.depth ? b : a);
            const avgDepth = data.reduce((sum, d) => sum + d.depth, 0) / data.length;
            infoPanel.innerHTML = `
                <strong>Chart Details:</strong> Long-term trend of effective recall depth by model version using empirical long-context benchmarks. The logarithmic scale shows exponential growth in how much context models can reliably use.
                Depth values are approximate midpoints of reported empirical recall ranges (e.g., 8K–12K for GPT‑3.5 Turbo, 500K–800K for Gemini 1.5 Pro and LongRoPE).
                <strong>${maxModel.model}</strong> currently has the highest effective recall depth at ${maxModel.depth.toLocaleString()} tokens. 
                Average across all models: ${(avgDepth / 1000).toFixed(0)}K tokens. Major jumps (marked with red annotations) signal critical moments where personalization capabilities dramatically increase.
            `;

            // Rationale section
            createCollapsibleRationale(container, `
                <div class="chart-rationale-content">
                    <p><strong>Methodology & Data Sources:</strong> Effective Recall Depth is derived from empirical long-context evaluations rather than advertised max context. For each model, we take the midpoint of reported recall ranges in public benchmarks and documentation, including:</p>
                    <ul class="chart-rationale-list">
                        <li><strong>OpenAI:</strong> GPT‑3.5 Turbo, GPT‑4, GPT‑4 Turbo, GPT‑4o long-context behavior from arXiv reports and OpenAI docs (e.g., <a href="https://arxiv.org/abs/2307.03172" target="_blank" rel="noopener noreferrer">2307.03172</a>, <a href="https://arxiv.org/abs/2310.15030" target="_blank" rel="noopener noreferrer">2310.15030</a>, and the GPT‑4o model card).</li>
                        <li><strong>Anthropic:</strong> Claude 2, Claude 2.1, Claude 3 Opus, and Sonnet effective recall from Anthropic release notes and model cards (<a href="https://www.anthropic.com/news/claude-2" target="_blank" rel="noopener noreferrer">Claude 2 launch</a>, <a href="https://www.anthropic.com/news/claude-2-1" target="_blank" rel="noopener noreferrer">Claude 2.1</a>, <a href="https://assets.anthropic.com/m/61e7d27f8c8f5919/original/Claude-3-Model-Card.pdf" target="_blank" rel="noopener noreferrer">Claude 3 model card</a>).</li>
                        <li><strong>Google:</strong> Gemini Pro 1.0 and Gemini 1.5 Flash/Pro long-context capabilities from Gemini technical reports and blog posts (<a href="https://arxiv.org/pdf/2403.05530" target="_blank" rel="noopener noreferrer">2403.05530</a>, <a href="https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/" target="_blank" rel="noopener noreferrer">Gemini 1.5 Flash update</a>).</li>
                        <li><strong>Microsoft:</strong> Copilot (GPT‑4 Turbo / GPT‑4o) and Phi‑3 family effective context from Microsoft OpenAI service docs and Phi‑3 papers (<a href="https://learn.microsoft.com/en-us/azure/ai-services/openai" target="_blank" rel="noopener noreferrer">Azure OpenAI</a>, <a href="https://arxiv.org/abs/2404.14219" target="_blank" rel="noopener noreferrer">Phi‑3</a>, <a href="https://arxiv.org/abs/2402.05188" target="_blank" rel="noopener noreferrer">LongRoPE</a>).</li>
                    </ul>
                    <p>Effective Recall Depth is the key predictor of personalization capability and lock-in risk. It measures how much context a model can maintain across conversations, directly correlating with:</p>
                    <ul class="chart-rationale-list">
                        <li><strong>Personalization quality:</strong> Deeper recall enables more sophisticated, context-aware personalization that users value highly</li>
                        <li><strong>Switching costs:</strong> As recall depth increases, users accumulate more contextual memory, making switching platforms progressively harder</li>
                        <li><strong>Lock-in acceleration:</strong> Models with >100K token recall create exponential lock-in — the more users engage, the more valuable the memory becomes</li>
                        <li><strong>Competitive dynamics:</strong> Rapid increases in recall depth (marked by red annotations) signal strategic investments in lock-in infrastructure</li>
                    </ul>
                </div>
                <div class="chart-rationale-section">
                    <strong>How to Interpret:</strong>
                    <p>The logarithmic scale reveals exponential growth in memory capacity. Major jumps (>100% growth) indicate breakthrough moments where personalization capabilities leap forward. The red high-risk zone (>100K tokens) represents territory where lock-in becomes nearly irreversible. Provider lines show competitive trajectories — convergence indicates commoditization, divergence signals competitive advantage.</p>
                </div>
                <div class="chart-rationale-section">
                    <strong>Strategic Actions:</strong>
                    <ul class="chart-rationale-list">
                        <li>Monitor recall depth increases — major jumps require immediate competitive response planning</li>
                        <li>Prioritize providers approaching or exceeding 100K tokens as highest lock-in risk</li>
                        <li>Use recall depth trends to time PLP interventions — rapid increases signal closing windows</li>
                        <li>Track which providers maintain deeper recall with more open systems — this is the differentiation opportunity</li>
                    </ul>
                </div>
            `, 'Methodology & Data Sources');
        }


        // Initialize dashboard
        window.addEventListener('load', function() {
            // Show only Ecosystem Moves by default
            showModule('ecosystem');
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            const activeModules = Array.from(document.querySelectorAll('.dashboard-section.active')).map(s => s.id);
            if (activeModules.includes('module-ecosystem')) renderEcosystemModule();
            if (activeModules.includes('module-memory')) renderMemoryModule();
        });
    </script>
</body>
</html>
